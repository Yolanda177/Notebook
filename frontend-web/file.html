<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æ–‡ä»¶å¤„ç† | Yolanda</title>
    <meta name="description" content="æ¯å¤©å­¦ä¹ ä¸€ç‚¹ç‚¹">
    <link rel="icon" href="/Notebook/images/mylogo.jpg">
    
    <link rel="preload" href="/Notebook/assets/css/0.styles.4f932b82.css" as="style"><link rel="preload" href="/Notebook/assets/js/app.fae3116e.js" as="script"><link rel="preload" href="/Notebook/assets/js/3.8a90166b.js" as="script"><link rel="preload" href="/Notebook/assets/js/5.01244a1f.js" as="script"><link rel="prefetch" href="/Notebook/assets/js/10.7c0500f6.js"><link rel="prefetch" href="/Notebook/assets/js/11.96ce6645.js"><link rel="prefetch" href="/Notebook/assets/js/12.295d52cd.js"><link rel="prefetch" href="/Notebook/assets/js/13.6db71019.js"><link rel="prefetch" href="/Notebook/assets/js/14.0c1400d8.js"><link rel="prefetch" href="/Notebook/assets/js/15.edab26a3.js"><link rel="prefetch" href="/Notebook/assets/js/16.88fd161d.js"><link rel="prefetch" href="/Notebook/assets/js/17.408350d5.js"><link rel="prefetch" href="/Notebook/assets/js/18.6ab68d1c.js"><link rel="prefetch" href="/Notebook/assets/js/19.9e9ef1da.js"><link rel="prefetch" href="/Notebook/assets/js/2.e3a9cac0.js"><link rel="prefetch" href="/Notebook/assets/js/20.56c42c66.js"><link rel="prefetch" href="/Notebook/assets/js/21.8d087c07.js"><link rel="prefetch" href="/Notebook/assets/js/22.cf2b0a03.js"><link rel="prefetch" href="/Notebook/assets/js/23.7413880a.js"><link rel="prefetch" href="/Notebook/assets/js/24.28bab990.js"><link rel="prefetch" href="/Notebook/assets/js/25.75c60686.js"><link rel="prefetch" href="/Notebook/assets/js/26.ef1edf61.js"><link rel="prefetch" href="/Notebook/assets/js/27.5aeea7cc.js"><link rel="prefetch" href="/Notebook/assets/js/28.8476b7e4.js"><link rel="prefetch" href="/Notebook/assets/js/29.956345a3.js"><link rel="prefetch" href="/Notebook/assets/js/30.b96e226e.js"><link rel="prefetch" href="/Notebook/assets/js/31.04440a69.js"><link rel="prefetch" href="/Notebook/assets/js/32.273112ca.js"><link rel="prefetch" href="/Notebook/assets/js/33.e709b2b3.js"><link rel="prefetch" href="/Notebook/assets/js/34.dc2136ae.js"><link rel="prefetch" href="/Notebook/assets/js/35.30ab0118.js"><link rel="prefetch" href="/Notebook/assets/js/36.cb41bc4a.js"><link rel="prefetch" href="/Notebook/assets/js/37.dd26a76e.js"><link rel="prefetch" href="/Notebook/assets/js/38.68398169.js"><link rel="prefetch" href="/Notebook/assets/js/39.93b8990e.js"><link rel="prefetch" href="/Notebook/assets/js/4.5f27db7e.js"><link rel="prefetch" href="/Notebook/assets/js/40.ed267aa9.js"><link rel="prefetch" href="/Notebook/assets/js/41.985eec03.js"><link rel="prefetch" href="/Notebook/assets/js/42.260a858d.js"><link rel="prefetch" href="/Notebook/assets/js/43.6cb97df7.js"><link rel="prefetch" href="/Notebook/assets/js/44.869ede03.js"><link rel="prefetch" href="/Notebook/assets/js/45.bf3e5a26.js"><link rel="prefetch" href="/Notebook/assets/js/46.a54b425c.js"><link rel="prefetch" href="/Notebook/assets/js/47.8ebe066b.js"><link rel="prefetch" href="/Notebook/assets/js/48.416ad307.js"><link rel="prefetch" href="/Notebook/assets/js/49.7394cd78.js"><link rel="prefetch" href="/Notebook/assets/js/50.4675f4c4.js"><link rel="prefetch" href="/Notebook/assets/js/51.a112471f.js"><link rel="prefetch" href="/Notebook/assets/js/52.a6195fbf.js"><link rel="prefetch" href="/Notebook/assets/js/53.15f5f0a8.js"><link rel="prefetch" href="/Notebook/assets/js/54.bbc6eb3c.js"><link rel="prefetch" href="/Notebook/assets/js/55.ba5d1f28.js"><link rel="prefetch" href="/Notebook/assets/js/56.2d5a7c0d.js"><link rel="prefetch" href="/Notebook/assets/js/57.b6f47637.js"><link rel="prefetch" href="/Notebook/assets/js/58.3ce0f8ce.js"><link rel="prefetch" href="/Notebook/assets/js/59.66784ebf.js"><link rel="prefetch" href="/Notebook/assets/js/6.4d03de1b.js"><link rel="prefetch" href="/Notebook/assets/js/60.2c355106.js"><link rel="prefetch" href="/Notebook/assets/js/61.1fb23164.js"><link rel="prefetch" href="/Notebook/assets/js/62.5ee4cd1c.js"><link rel="prefetch" href="/Notebook/assets/js/63.08a71f63.js"><link rel="prefetch" href="/Notebook/assets/js/64.e7464a6a.js"><link rel="prefetch" href="/Notebook/assets/js/65.de9108af.js"><link rel="prefetch" href="/Notebook/assets/js/66.83e75f1b.js"><link rel="prefetch" href="/Notebook/assets/js/67.3caaf58d.js"><link rel="prefetch" href="/Notebook/assets/js/68.2dd69095.js"><link rel="prefetch" href="/Notebook/assets/js/69.927efe78.js"><link rel="prefetch" href="/Notebook/assets/js/7.a97cfeeb.js"><link rel="prefetch" href="/Notebook/assets/js/70.92fd8264.js"><link rel="prefetch" href="/Notebook/assets/js/71.0ef73e07.js"><link rel="prefetch" href="/Notebook/assets/js/72.7e0a2fee.js"><link rel="prefetch" href="/Notebook/assets/js/73.816bc4b8.js"><link rel="prefetch" href="/Notebook/assets/js/74.e1c44e90.js"><link rel="prefetch" href="/Notebook/assets/js/75.52d5991e.js"><link rel="prefetch" href="/Notebook/assets/js/76.3ab263b9.js"><link rel="prefetch" href="/Notebook/assets/js/77.76e6e752.js"><link rel="prefetch" href="/Notebook/assets/js/78.e2711be8.js"><link rel="prefetch" href="/Notebook/assets/js/79.ecf0c259.js"><link rel="prefetch" href="/Notebook/assets/js/8.698b291a.js"><link rel="prefetch" href="/Notebook/assets/js/80.6defbc57.js"><link rel="prefetch" href="/Notebook/assets/js/81.650b6435.js"><link rel="prefetch" href="/Notebook/assets/js/82.f41e2c82.js"><link rel="prefetch" href="/Notebook/assets/js/83.62a3d0ce.js"><link rel="prefetch" href="/Notebook/assets/js/84.f2e0ba7a.js"><link rel="prefetch" href="/Notebook/assets/js/85.7d5af1cd.js"><link rel="prefetch" href="/Notebook/assets/js/86.883b02f7.js"><link rel="prefetch" href="/Notebook/assets/js/87.dc5913fb.js"><link rel="prefetch" href="/Notebook/assets/js/88.369e5f01.js"><link rel="prefetch" href="/Notebook/assets/js/89.fd496723.js"><link rel="prefetch" href="/Notebook/assets/js/9.220abfab.js"><link rel="prefetch" href="/Notebook/assets/js/90.1d16c82f.js"><link rel="prefetch" href="/Notebook/assets/js/91.6bcdcb57.js"><link rel="prefetch" href="/Notebook/assets/js/92.3f6beaea.js"><link rel="prefetch" href="/Notebook/assets/js/93.d98ca184.js">
    <link rel="stylesheet" href="/Notebook/assets/css/0.styles.4f932b82.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Notebook/" class="home-link router-link-active"><!----> <span class="site-name">Yolanda</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Notebook/dailyRecord/" class="nav-link">ğŸ“æ—¥å¸¸è®°å½•</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">å¼€å‘è€…</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notebook/frontend-web/" class="nav-link router-link-active">ğŸ’»å¤§å‰ç«¯</a></li><li class="dropdown-item"><!----> <a href="/Notebook/rethink/" class="nav-link">ğŸ¤”å¤ç›˜</a></li><li class="dropdown-item"><h4>ï¸ï¸ğŸ§˜ç®—æ³•ä¿®ç‚¼</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Notebook/algorithm/computerBasics.html" class="nav-link">è®¡ç®—æœºåŸºç¡€</a></li><li class="dropdown-subitem"><a href="/Notebook/algorithm/dataStructure.html" class="nav-link">æ•°æ®ç»“æ„</a></li><li class="dropdown-subitem"><a href="/Notebook/algorithm/algorithm.html" class="nav-link">ç®—æ³•åˆ†ç±»</a></li><li class="dropdown-subitem"><a href="/Notebook/dataBase/index.html" class="nav-link">æ•°æ®åº“</a></li></ul></li><li class="dropdown-item"><!----> <a href="/Notebook/devops/" class="nav-link">â˜ï¸è¿ç»´</a></li><li class="dropdown-item"><!----> <a href="/Notebook/test/" class="nav-link">ğŸš¬æµ‹è¯•</a></li><li class="dropdown-item"><!----> <a href="/Notebook/gis/" class="nav-link">ğŸŒGIS</a></li><li class="dropdown-item"><!----> <a href="/Notebook/software/" class="nav-link">ï¸ï¸ğŸ–±ï¸è½¯ä»¶</a></li><li class="dropdown-item"><!----> <a href="/Notebook/network/" class="nav-link">ï¸ï¸ğŸ›ç½‘ç»œå·¥ç¨‹</a></li><li class="dropdown-item"><!----> <a href="/Notebook/csharp/" class="nav-link">ğŸš—C#</a></li><li class="dropdown-item"><!----> <a href="/Notebook/unity/" class="nav-link">ğŸ®Unity</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">è®¾è®¡</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notebook/design/" class="nav-link">ğŸ–Œï¸UI</a></li></ul></div></div><div class="nav-item"><a href="/Notebook/bookmark/" class="nav-link">ğŸ·ä¹¦ç­¾æ•´ç†</a></div><div class="nav-item"><a href="/Notebook/lint/" class="nav-link">âœ”ï¸ç¼–ç è§„èŒƒ&amp;ååŒå¼€å‘</a></div><div class="nav-item"><a href="http://shooterblog.site/Learn-JS-Demo/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ“–çŸ¥è¯†è„‘å›¾
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://jecyu.github.io/blog/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ”§ä¸ªäººåšå®¢
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">ğŸ”—Github</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Yolanda177" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Yolanda github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jecyu.github.io/language-learning/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  è‹±è¯­å­¦ä¹ 
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jecyu.github.io/Fe-Auto-Testing/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  å‰ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Notebook/dailyRecord/" class="nav-link">ğŸ“æ—¥å¸¸è®°å½•</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">å¼€å‘è€…</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notebook/frontend-web/" class="nav-link router-link-active">ğŸ’»å¤§å‰ç«¯</a></li><li class="dropdown-item"><!----> <a href="/Notebook/rethink/" class="nav-link">ğŸ¤”å¤ç›˜</a></li><li class="dropdown-item"><h4>ï¸ï¸ğŸ§˜ç®—æ³•ä¿®ç‚¼</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Notebook/algorithm/computerBasics.html" class="nav-link">è®¡ç®—æœºåŸºç¡€</a></li><li class="dropdown-subitem"><a href="/Notebook/algorithm/dataStructure.html" class="nav-link">æ•°æ®ç»“æ„</a></li><li class="dropdown-subitem"><a href="/Notebook/algorithm/algorithm.html" class="nav-link">ç®—æ³•åˆ†ç±»</a></li><li class="dropdown-subitem"><a href="/Notebook/dataBase/index.html" class="nav-link">æ•°æ®åº“</a></li></ul></li><li class="dropdown-item"><!----> <a href="/Notebook/devops/" class="nav-link">â˜ï¸è¿ç»´</a></li><li class="dropdown-item"><!----> <a href="/Notebook/test/" class="nav-link">ğŸš¬æµ‹è¯•</a></li><li class="dropdown-item"><!----> <a href="/Notebook/gis/" class="nav-link">ğŸŒGIS</a></li><li class="dropdown-item"><!----> <a href="/Notebook/software/" class="nav-link">ï¸ï¸ğŸ–±ï¸è½¯ä»¶</a></li><li class="dropdown-item"><!----> <a href="/Notebook/network/" class="nav-link">ï¸ï¸ğŸ›ç½‘ç»œå·¥ç¨‹</a></li><li class="dropdown-item"><!----> <a href="/Notebook/csharp/" class="nav-link">ğŸš—C#</a></li><li class="dropdown-item"><!----> <a href="/Notebook/unity/" class="nav-link">ğŸ®Unity</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">è®¾è®¡</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notebook/design/" class="nav-link">ğŸ–Œï¸UI</a></li></ul></div></div><div class="nav-item"><a href="/Notebook/bookmark/" class="nav-link">ğŸ·ä¹¦ç­¾æ•´ç†</a></div><div class="nav-item"><a href="/Notebook/lint/" class="nav-link">âœ”ï¸ç¼–ç è§„èŒƒ&amp;ååŒå¼€å‘</a></div><div class="nav-item"><a href="http://shooterblog.site/Learn-JS-Demo/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ“–çŸ¥è¯†è„‘å›¾
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://jecyu.github.io/blog/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ”§ä¸ªäººåšå®¢
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">ğŸ”—Github</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Yolanda177" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Yolanda github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jecyu.github.io/language-learning/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  è‹±è¯­å­¦ä¹ 
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jecyu.github.io/Fe-Auto-Testing/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  å‰ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>å‰ç«¯</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Notebook/frontend-web/browser.html" class="sidebar-link">æµè§ˆå™¨</a></li><li><a href="/Notebook/frontend-web/css.html" class="sidebar-link">CSS</a></li><li><a href="/Notebook/frontend-web/javascript.html" class="sidebar-link">JavaScript</a></li><li><a href="/Notebook/frontend-web/es6.html" class="sidebar-link">ES6</a></li><li><a href="/Notebook/frontend-web/react.html" class="sidebar-link">React</a></li><li><a href="/Notebook/frontend-web/vue.html" class="sidebar-link">Vue</a></li><li><a href="/Notebook/frontend-web/webpack.html" class="sidebar-link">webpack</a></li><li><a href="/Notebook/frontend-web/" class="sidebar-link">å·¥ç¨‹åŒ–</a></li><li><a href="/Notebook/frontend-web/modulization.html" class="sidebar-link">æ¨¡å—åŒ–</a></li><li><a href="/Notebook/frontend-web/architecture.html" class="sidebar-link">æ¶æ„</a></li><li><a href="/Notebook/frontend-web/authentication.html" class="sidebar-link">é‰´æƒ&amp;&amp;è®¤è¯</a></li><li><a href="/Notebook/frontend-web/chrome.html" class="sidebar-link">chrome è°ƒè¯•æŠ€å·§</a></li><li><a href="/Notebook/frontend-web/noJQ.html" class="sidebar-link">You (Might) Don't Need jQuery</a></li><li><a href="/Notebook/frontend-web/performance.html" class="sidebar-link">æ€§èƒ½ä¼˜åŒ–</a></li><li><a href="/Notebook/frontend-web/npm.html" class="sidebar-link">npm</a></li><li><a href="/Notebook/frontend-web/lodash.html" class="sidebar-link">lodash æºç åˆ†æåŠæ€è·¯å­¦ä¹ </a></li><li><a href="/Notebook/frontend-web/babel.html" class="sidebar-link">Babel</a></li><li><a href="/Notebook/frontend-web/rollup.html" class="sidebar-link">rollup</a></li><li><a href="/Notebook/frontend-web/docker.html" class="sidebar-link">Docker</a></li><li><a href="/Notebook/frontend-web/security.html" class="sidebar-link">å‰ç«¯å®‰å…¨</a></li><li><a href="/Notebook/frontend-web/file.html" class="active sidebar-link">æ–‡ä»¶å¤„ç†</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#å¸¸è§åœºæ™¯" class="sidebar-link">å¸¸è§åœºæ™¯</a></li><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#æµ" class="sidebar-link">æµ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#ä¸ºä»€ä¹ˆè¦æœ‰æµ" class="sidebar-link">ä¸ºä»€ä¹ˆè¦æœ‰æµ</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#ä¸Šä¼ " class="sidebar-link">ä¸Šä¼ </a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#è¡¨å•ä¸Šä¼ " class="sidebar-link">è¡¨å•ä¸Šä¼ </a></li><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#formdata-å¼‚æ­¥ä¸Šä¼ " class="sidebar-link">formData å¼‚æ­¥ä¸Šä¼ </a></li><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#æ‹–æ‹½ä¸Šä¼ " class="sidebar-link">æ‹–æ‹½ä¸Šä¼ </a></li><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#ç²˜è´´ä¸Šä¼ " class="sidebar-link">ç²˜è´´ä¸Šä¼ </a></li><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#å¤§æ–‡ä»¶æ–­ç‚¹ç»­ä¼ " class="sidebar-link">å¤§æ–‡ä»¶æ–­ç‚¹ç»­ä¼ </a></li><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#æ–‡ä»¶å¤¹ä¸Šä¼ " class="sidebar-link">æ–‡ä»¶å¤¹ä¸Šä¼ </a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#ä¸‹è½½" class="sidebar-link">ä¸‹è½½</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#aæ ‡ç­¾ä¸‹è½½" class="sidebar-link">aæ ‡ç­¾ä¸‹è½½</a></li><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#location-hrefä¸‹è½½" class="sidebar-link">location.hrefä¸‹è½½</a></li><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#iframeä¸‹è½½" class="sidebar-link">iframeä¸‹è½½</a></li><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#filesaver-ä¸‹è½½" class="sidebar-link">FileSaver ä¸‹è½½</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#æ–‡ä»¶ä¸‹è½½" class="sidebar-link">æ–‡ä»¶ä¸‹è½½</a></li><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#æ–‡ä»¶åœ¨çº¿ç”Ÿæˆ" class="sidebar-link">æ–‡ä»¶åœ¨çº¿ç”Ÿæˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#æˆªå›¾" class="sidebar-link">æˆªå›¾</a></li></ul></li><li class="sidebar-sub-header"><a href="/Notebook/frontend-web/file.html#å‚è€ƒèµ„æ–™" class="sidebar-link">å‚è€ƒèµ„æ–™</a></li></ul></li><li><a href="/Notebook/frontend-web/interview.html" class="sidebar-link">å¸¸è§é—®é¢˜ 1</a></li><li><a href="/Notebook/frontend-web/interview2.html" class="sidebar-link">å¸¸è§é—®é¢˜ 2</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="æ–‡ä»¶å¤„ç†"><a href="#æ–‡ä»¶å¤„ç†" aria-hidden="true" class="header-anchor">#</a> æ–‡ä»¶å¤„ç†</h1> <p>æœ¬è´¨ï¼šæµæ–‡ä»¶çš„è·å–å’Œè½¬æ¢ã€‚</p> <h2 id="å¸¸è§åœºæ™¯"><a href="#å¸¸è§åœºæ™¯" aria-hidden="true" class="header-anchor">#</a> å¸¸è§åœºæ™¯</h2> <ul><li>é€šè¿‡ input ä¸Šä¼ </li> <li>æ–‡ä»¶æ‹–æ‹½ä¸Šä¼ </li> <li>æ–‡ä»¶åœ¨çº¿é¢„è§ˆ</li> <li>æ–‡ä»¶</li> <li>ç¬¬ä¸‰æ–¹æ¥å£éœ€è¦</li></ul> <h2 id="æµ"><a href="#æµ" aria-hidden="true" class="header-anchor">#</a> æµ</h2> <p>ä¸€åˆ‡èƒ½è¢«è¯»å†™çš„éƒ½æ˜¯æ–‡ä»¶ï¼Œæµæ˜¯è¯»å–æ–‡ä»¶çš„æŠ½è±¡ã€‚æµï¼ˆStreamï¼‰å°±æ˜¯æŒ‡åƒæ°´æµä¸€æ ·é•¿é•¿çš„ä¸€ä¸²ä¸œè¥¿ï¼Œæµåªæœ‰ä¸€ä¸ªç‰¹å¾æ˜¯è¿ç»­çš„ã€‚</p> <h3 id="ä¸ºä»€ä¹ˆè¦æœ‰æµ"><a href="#ä¸ºä»€ä¹ˆè¦æœ‰æµ" aria-hidden="true" class="header-anchor">#</a> ä¸ºä»€ä¹ˆè¦æœ‰æµ</h3> <p>å‡è®¾æ²¡æœ‰æµ, æ‰€æœ‰çš„æ•°æ®éƒ½å¯ä»¥ç”¨äºŒè¿›åˆ¶ä¸²æ¥è¡¨ç¤ºï¼Œè¿™æ · CPU è¯»å–ä¹Ÿä¸ä¼šæ…¢ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆè¦æœ‰æµå‘¢ï¼Ÿ
å¸¸è§çš„éœ€æ±‚æ¯”å¦‚æ’­æ”¾è§†é¢‘çš„æ—¶å€™, æˆ‘ä»¬è‚¯å®šæ˜¯å¸Œæœ›ä»ç¡¬ç›˜(æˆ–è€…ç½‘ç»œ)è¯»å–ä¸€ç‚¹, æ’­æ”¾ä¸€ç‚¹, ä¸€ä¸ªè§†é¢‘ 4GB, è¦æ˜¯å…¨éƒ¨è½½å…¥å†…å­˜æ‰èƒ½æ’­æ”¾, å¥½å¤šäººéƒ½çœ‹ä¸æˆ 1080p çš„äº†.æ‰€ä»¥, æˆ‘ä»¬æœ‰å……åˆ†çš„ç†ç”±æŠŠè¿™ç§è¯»ä¸€ç‚¹å¤„ç†ä¸€ç‚¹(ä»¥åŠç›¸åçš„ç”Ÿæˆä¸€ç‚¹, å†™å…¥ä¸€ç‚¹)çš„æ•°æ®ç±»å‹(æˆ–æ›°æ“ä½œ)æŠ½è±¡å‡ºæ¥, è¿™å°±æ˜¯æµã€‚</p> <p>æµæ•°æ®æœ€å°å•ä½ä¹Ÿæ˜¯å­—èŠ‚ï¼ˆbyte)ã€‚å¸¸è§çš„æœ‰å­—èŠ‚æµã€æ–‡æœ¬æµã€å›¾ç‰‡æµã€éŸ³é¢‘æµã€è§†é¢‘æµã€æ•°æ®æµã€‚</p> <ul><li>å›¾ç‰‡æµå°±æ˜¯ç”¨äºŒè¿›åˆ¶æµæ¥è¡¨ç¤ºå›¾ç‰‡ã€‚</li> <li>äºŒè¿›åˆ¶æµæ˜¯æŒ‡æµåŠ¨çš„æ˜¯äºŒè¿›åˆ¶æ•°å­—åºåˆ—ã€‚</li> <li>æ–‡æœ¬æµæ˜¯æŒ‡æµåŠ¨çš„æ•°æ®æ˜¯ä»¥å­—ç¬¦å½¢å¼å‡ºç°ã€‚</li></ul> <h2 id="ä¸Šä¼ "><a href="#ä¸Šä¼ " aria-hidden="true" class="header-anchor">#</a> ä¸Šä¼ </h2> <p>å‰ç«¯è¿›è¡Œ <strong>ä¸Šä¼ </strong> çš„æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œæˆ‘ä»¬ä¼šæ ¹æ®ä¸åŒçš„éœ€æ±‚é€‰æ‹©ä¸åŒæ–¹å¼å®ç°ä¸Šä¼ çš„åŠŸèƒ½ï¼Œä¸‹é¢æ˜¯æˆ‘æ€»ç»“çš„å‡ ç§æ¯”è¾ƒå¸¸ç”¨çš„ä¸Šä¼ æ–¹å¼ï¼Œå½“ç„¶ç°åœ¨çš„å¾ˆå¤šç»„ä»¶åº“å·²ç»å°è£…å¥½è¿™äº›å·¥å…·æ–¹æ³•ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨å°±å¯ä»¥äº†ï¼Œä½†æœ‰æ—¶å€™é‡ä¸Šé—®é¢˜åˆæ— ä»ä¸‹æ‰‹ï¼Œè¿˜æ˜¯è¦ä»æ–°çœ‹ä¸€éæºç æ‰è¡Œï¼Œæ‰€ä»¥ä»¥ä¸‹éƒ½æ˜¯å®ç°ä¸Šä¼ æ¯”è¾ƒåŸç”Ÿçš„æ–¹å¼ï¼Œç®€å•æ —å­å¸Œæœ›å¤§å®¶èƒ½å¤Ÿæ¥å—ã€‚</p> <ul><li>è¡¨å•ä¸Šä¼ (åŒ…æ‹¬ iframeã€jqueryä½¿ç”¨)</li> <li>formData ä¸Šä¼ </li> <li>æ‹–æ‹½ä¸Šä¼ </li> <li>ç²˜è´´ä¸Šä¼ </li> <li>å¤§æ–‡ä»¶æ–­ç‚¹ç»­ä¼ </li></ul> <h3 id="è¡¨å•ä¸Šä¼ "><a href="#è¡¨å•ä¸Šä¼ " aria-hidden="true" class="header-anchor">#</a> è¡¨å•ä¸Šä¼ </h3> <p>æˆ‘ä»¬çŸ¥é“å¦‚æœè¦ç”¨è¡¨å•ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œæœ‰ä¸¤ç‚¹æ˜¯å¿…é¡»è®¾ç½®çš„ï¼Œä¸€æ˜¯éœ€è¦æŠŠ <code>form</code> æ ‡ç­¾çš„ <code>enctype</code> è®¾ç½®ä¸º <code>multipart/form-data</code> , äºŒæ˜¯ <code>form</code> æ ‡ç­¾çš„ <code>method</code> å¿…é¡»ä¸º <code>post</code> æ–¹æ³•ã€‚é‚£ä¹ˆè¿™ä¸ª <code>enctype</code> ä»£è¡¨çš„æ˜¯ä»€ä¹ˆï¼Ÿ <code>multipart/form-data</code> åˆæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p> <p><code>enctype</code> å±æ€§è§„å®šäº†åœ¨å‘é€åˆ°æœåŠ¡å™¨ä¹‹å‰åº”è¯¥å¦‚ä½•å¯¹è¡¨å•æ•°æ®è¿›è¡Œç¼–ç ï¼Œé»˜è®¤æƒ…å†µä¸‹è¿™ä¸ªå±æ€§çš„å€¼æ˜¯ï¼š <code>application/x-www-form-urlencoded</code>,ä¹Ÿå°±æ˜¯å¯¹æ‰€æœ‰å­—ç¬¦éƒ½ä¼šè¿›è¡Œç¼–ç ã€‚è€Œæˆ‘ä»¬è®¾ç½®çš„ <code>mutipart/form-data</code> å°±ä¸ä¼šå¯¹å­—ç¬¦ç¼–ç ã€‚</p> <p>å¦‚å›¾ï¼š
å®é™…ä¸Šï¼Œè¯·æ±‚æ—¶è¡¨å•è®¾ç½®çš„ <code>enctype = &quot;multipart/form-data&quot;</code> ä¼šè¢«è¯†åˆ«æˆè¯·æ±‚å¤´(Request Headers)ä¸­çš„ <code>Content-type: multipart/form-data</code>ï¼Œ<code>multipart</code> æ˜¯æŒ‡äº’è”ç½‘ä¸Šçš„æ··åˆèµ„æºï¼Œèµ„æºå¯ä»¥ç”±å¤šç§å…ƒç´ ç»„æˆï¼Œ<code>form-data</code> è¡¨ç¤ºå¯ä»¥ä½¿ç”¨ <code>HTML Form</code> å’Œ <code>POST</code> æ–¹æ³•ä¸Šä¼ æ–‡ä»¶ï¼Œè€Œ <code>boundary</code> è¡¨ç¤ºåˆ†éš”ç¬¦ï¼Œå½“æˆ‘ä»¬è¦ä¸Šä¼ å¤šä¸ªè¡¨å•é¡¹æ—¶ï¼Œå°±è¦ä½¿ç”¨ <code>boundary</code> åˆ†å‰²ã€‚</p> <p><img src="/Notebook/assets/img/http.1c428c7a.jpg" alt=""></p> <p>ç¬¬ä¸€ä¸ªæ —å­ï¼šè¿™æ˜¯ä¸€ä¸ªéå¸¸åŸå§‹çš„ä¸Šä¼ æ–‡ä»¶çš„æ–¹å¼ï¼Œç‚¹å‡» <code>submit</code> åé¡µé¢ä¼šè·³è½¬åˆ°è¡¨å• <code>action</code> æŒ‡å‘çš„é¡µé¢ï¼Œè¿™ç§æ–¹å¼æ˜¯éœ€è¦æ”¹è¿›çš„ï¼Œå¦åˆ™é¡µé¢çš„å…¶ä»–æ•°æ®å°±ä¼šä¸¢å¤±ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token operator">&lt;</span>form id<span class="token operator">=</span><span class="token string">&quot;form2&quot;</span> method<span class="token operator">=</span><span class="token string">&quot;post&quot;</span> action<span class="token operator">=</span><span class="token string">&quot;http://localhost:8100/upload-form&quot;</span> enctype<span class="token operator">=</span><span class="token string">&quot;multipart/form-data&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Choose file to upload<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span>
    å¦‚æœæ˜¯å¤šæ–‡ä»¶ä¸Šä¼ ï¼Œinput æ·»åŠ  multiple å±æ€§å³å¯
    å•æ–‡ä»¶ï¼š<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;file&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;f1&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;f1&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span>
    å¤šæ–‡ä»¶ï¼š<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;file&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;f1&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;f1&quot;</span> multiple <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span>
    input å¿…é¡»è®¾ç½® name å±æ€§ï¼Œå¦åˆ™æ•°æ®æ— æ³•å‘é€<span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">&quot;submit&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;btn-0&quot;</span><span class="token operator">&gt;</span>ä¸Š ä¼ <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;but2&quot;</span><span class="token operator">&gt;</span>ä¸Šä¼ <span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
</code></pre></div><p>è¦è§£å†³åˆ·æ–°é¡µé¢çš„é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// ç¬¬ä¸€ç§ ç”¨ ajaxSubmit æäº¤æ•°æ®</span>
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.but2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#form2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ajaxSubmit</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token function-variable function">success</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">responseText</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'ä¸Šä¼ æˆæœï¼'</span><span class="token punctuation">)</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>responseText<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// ç¬¬äºŒç§</span>
  <span class="token comment">// åœ¨ form æ ‡ç­¾ä¸Šæ·»åŠ  target å±æ€§ï¼Œå€¼ä¸º iframe æ ‡ç­¾çš„ nameå€¼</span>
  <span class="token comment">// target å±æ€§è§„å®šåœ¨ä½•å¤„æ‰“å¼€ action URLï¼Œé»˜è®¤æƒ…å†µå°±æ˜¯ _blank åœ¨æ–°çš„çª—å£æ‰“å¼€ï¼Œè¿™é‡Œé…ç½®çš„æ˜¯ iframe çš„ nameå€¼ï¼Œä¼šåœ¨è¿™ä¸ªæŒ‡å®šçš„ iframe æ¡†æ¶æ‰“å¼€</span>
  <span class="token operator">&lt;</span>iframe id<span class="token operator">=</span><span class="token string">&quot;temp-iframe&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;temp-iframe&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;display:none;&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>form method<span class="token operator">=</span><span class="token string">&quot;post&quot;</span> target<span class="token operator">=</span><span class="token string">&quot;temp-iframe&quot;</span> action<span class="token operator">=</span><span class="token string">&quot;http://localhost:8100/upload-form&quot;</span> enctype<span class="token operator">=</span><span class="token string">&quot;multipart/form-data&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Choose file to upload<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;file&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;f1&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;f1&quot;</span> multiple <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">&quot;submit&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;btn-0&quot;</span><span class="token operator">&gt;</span>ä¸Š ä¼ <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
</code></pre></div><p>ä»‹ç»ä¸€ä¸‹è¿™æ¬¡ä¸Šä¼ çš„æœåŠ¡ç«¯ï¼Œç”¨çš„æ˜¯ <strong>node js</strong> + <strong>fs</strong>  + <strong>koa</strong> æ¡†æ¶å†™çš„æœåŠ¡ç«¯</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * æœåŠ¡å…¥å£
 */</span>
  <span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> koaStatic <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa-static'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa-body'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> port <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token string">'8100'</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> uploadHost <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://localhost:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/uploads/</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    formidable<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment">//è®¾ç½®æ–‡ä»¶çš„é»˜è®¤ä¿å­˜ç›®å½•ï¼Œä¸è®¾ç½®åˆ™ä¿å­˜åœ¨ç³»ç»Ÿä¸´æ—¶ç›®å½•ä¸‹  os</span>
        uploadDir<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../static/uploads'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    multipart<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment">// æ”¯æŒæ–‡ä»¶ä¸Šä¼ </span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//å¼€å¯é™æ€æ–‡ä»¶è®¿é—®</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaStatic</span><span class="token punctuation">(</span>
    path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../static'</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//äºŒæ¬¡å¤„ç†æ–‡ä»¶ï¼Œä¿®æ”¹åç§°</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">'/upload-form'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> files <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>files<span class="token punctuation">.</span>f1<span class="token punctuation">;</span><span class="token comment">//å¾—åˆ°ä¸Šä¼ æ–‡ä»¶çš„æ•°ç»„</span>
        <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            files <span class="token operator">=</span> <span class="token punctuation">[</span>files<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        files <span class="token operator">&amp;&amp;</span> files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
            <span class="token keyword">var</span> path <span class="token operator">=</span> item<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\/g</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> fname <span class="token operator">=</span> item<span class="token punctuation">.</span>name<span class="token punctuation">;</span><span class="token comment">//åŸæ–‡ä»¶åç§°</span>
            <span class="token keyword">var</span> nextPath <span class="token operator">=</span> path <span class="token operator">+</span> fname<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>size <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//å¾—åˆ°æ‰©å±•å</span>
                <span class="token keyword">var</span> extArr <span class="token operator">=</span> fname<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> ext <span class="token operator">=</span> extArr<span class="token punctuation">[</span>extArr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> nextPath <span class="token operator">=</span> path <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> ext<span class="token punctuation">;</span>
                <span class="token comment">//é‡å‘½åæ–‡ä»¶</span>
                fs<span class="token punctuation">.</span><span class="token function">renameSync</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> nextPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

                result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>uploadHost <span class="token operator">+</span> nextPath<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>nextPath<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{
            &quot;fileUrl&quot;:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
        }</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">/**
  * http server
  */</span>
  <span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'demo1 server start ......   '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="æ€»ç»“"><a href="#æ€»ç»“" aria-hidden="true" class="header-anchor">#</a> æ€»ç»“</h4> <p>è¡¨å•ä¸Šä¼ æ–‡ä»¶æ˜¯æ¯”è¾ƒåŸå§‹çš„ä¸€ç§æ–¹å¼ï¼Œä½†ä¹Ÿæ˜¯æ¯”è¾ƒåŸºç¡€çš„ï¼Œåœ¨è¿™ä¸ªåŸºç¡€ä¸Šå‘å±•äº†å…¶ä»–æ›´æ–¹ä¾¿çš„æ–¹å¼å®ç°ä¸Šä¼ ï¼Œå¾ˆå¤šç»„ä»¶åº“å°è£…çš„ä¸Šä¼ ç»„ä»¶ä¹Ÿæ˜¯æ ¹æ®è¿™äº›åŸç†ä¸Šä¼ æ–‡ä»¶ã€‚</p> <h3 id="formdata-å¼‚æ­¥ä¸Šä¼ "><a href="#formdata-å¼‚æ­¥ä¸Šä¼ " aria-hidden="true" class="header-anchor">#</a> formData å¼‚æ­¥ä¸Šä¼ </h3> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/FormData" target="_blank" rel="noopener noreferrer">formData<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ä¸€å¼€å§‹ç”¨äºå®ç°è¡¨å•æ•°æ®çš„åºåˆ—åŒ–ï¼Œèƒ½å¤Ÿå°†è¡¨å•å…ƒç´ çš„ <code>name</code> å’Œ <code>value</code> è¿›è¡Œç»„åˆï¼Œå‡å°‘è¡¨å•å…ƒç´ çš„æ‹¼æ¥ä¸Šä¼ ï¼›åæ¥ç»“åˆ <code>file</code> å¯¹è±¡ç”¨äºå¼‚æ­¥è¯·æ±‚ä¸Šä¼ æ–‡ä»¶ã€‚å½“æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œä¼šå‡ºç°æœåŠ¡å™¨è¶…æ—¶çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šè€ƒè™‘é‡‡ç”¨å¼‚æ­¥ä¸Šä¼ çš„æ–¹å¼ï¼Œä»¥ä¸‹æ˜¯åˆ©ç”¨æ„é€  FormData å¯¹è±¡æ¨¡æ‹Ÿè¡¨å•ä¸Šä¼ ã€‚</p> <p>è·å–æ–‡ä»¶å¯¹è±¡ä¸€èˆ¬é€šè¿‡ <code>input</code> æ ‡ç­¾å°±å¯ä»¥æ‹¿åˆ°ï¼Œä½†è¿™ä¸ªæ ·å¼ä¸å¤ªç¾è§‚ï¼Œå¾ˆå¤šç»„ä»¶åº“å°è£…çš„ä¸Šä¼ ç»„ä»¶éƒ½æœ‰ç±»ä¼¼çš„åŠŸèƒ½æ‹¿åˆ° <code>file</code> å¯¹è±¡</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">function</span> <span class="token function">submitUpload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//è·å¾—æ–‡ä»¶åˆ—è¡¨ï¼Œæ³¨æ„è¿™é‡Œä¸æ˜¯æ•°ç»„ï¼Œè€Œæ˜¯å¯¹è±¡</span>
      <span class="token keyword">const</span> fileList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'f1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>files<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fileList<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'è¯·é€‰æ‹©æ–‡ä»¶'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">//æ„é€ FormDataå¯¹è±¡</span>
      <span class="token keyword">const</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//å¤šæ–‡ä»¶ä¸Šä¼ éœ€è¦éå†æ·»åŠ åˆ° fromdata å¯¹è±¡</span>
      Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>fileList<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">f</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8100/upfile'</span><span class="token punctuation">,</span> fd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'ä¸Šä¼ æˆåŠŸ'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token comment">// åŸç”Ÿä½¿ç”¨ xhr</span>
      <span class="token comment">// const xhr = new XMLHttpRequest();   //åˆ›å»ºå¯¹è±¡</span>
      <span class="token comment">// xhr.open('POST', 'http://localhost:8100/upfile', true)</span>
      <span class="token comment">// //å‘é€æ—¶  Content-Typeé»˜è®¤å°±æ˜¯: multipart/form-data; </span>
      <span class="token comment">// xhr.send(fd)</span>
      <span class="token comment">// xhr.onreadystatechange = function () {</span>
      <span class="token comment">//     console.log('state change', xhr.readyState);</span>
      <span class="token comment">//     if (this.readyState == 4 &amp;&amp; this.status == 200) {</span>
      <span class="token comment">//      var obj = JSON.parse(xhr.responseText);   //è¿”å›å€¼</span>
      <span class="token comment">//       console.log(obj);</span>
      <span class="token comment">//       if (obj.fileUrl.length) {</span>
      <span class="token comment">//        alert('ä¸Šä¼ æˆåŠŸ');</span>
      <span class="token comment">//       }</span>
      <span class="token comment">//     }</span>
      <span class="token comment">//  }</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>æµè§ˆå™¨æ–‡ä»¶ä¸‹è½½ä¼šè‡ªå¸¦è¿›åº¦æ˜¾ç¤ºï¼Œé‚£æˆ‘ä»¬æ–‡ä»¶ä¸Šä¼ ä¹Ÿå½“ç„¶æœ‰å¯¹åº”çš„è¿›åº¦æé†’ï¼Œå¦‚ä½•è·å–æˆ‘ä»¬æ–‡ä»¶ä¸Šä¼ çš„è¿›åº¦å‘¢ï¼Ÿå¦‚æœç»†å¿ƒé˜…è¯»è¿‡ <a href="https://www.npmjs.com/package/axios#request-config" target="_blank" rel="noopener noreferrer">axios<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å®˜æ–¹æ–‡æ¡£è‚¯å®šçŸ¥é“,è¯·æ±‚é…ç½®é‡Œæœ‰ä¸ª <code>onUploadProgress</code> äº‹ä»¶ï¼Œå°±æ˜¯è¿™é‡Œæˆ‘ä»¬èƒ½å¤Ÿå®æ—¶çš„ç›‘å¬åˆ°æ–‡ä»¶ä¸Šä¼ çš„è¿›åº¦ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">const</span> progressSpan <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'progress'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>firstElementChild
  <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">onUploadProgress</span><span class="token punctuation">:</span> <span class="token parameter">progressEvent</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> complete <span class="token operator">=</span> <span class="token punctuation">(</span>progressEvent<span class="token punctuation">.</span>loaded <span class="token operator">/</span> progressEvent<span class="token punctuation">.</span>total <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">)</span>
      progressSpan<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> complete <span class="token operator">+</span> <span class="token string">'0px'</span>
      progressSpan<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> complete
      <span class="token keyword">if</span> <span class="token punctuation">(</span>complete <span class="token operator">===</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//è¿›åº¦æ¡å˜è‰²</span>
        progressSpan<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8100/upfile'</span><span class="token punctuation">,</span> fd<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'ä¸Šä¼ æˆåŠŸ'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// å¦‚æœæƒ³è¦äº†è§£åŸç”Ÿçš„ XMLHttpRequest2 è¿›åº¦æ¡å†™æ³•,å¯ä»¥å‚è€ƒä¸‹é¢æ —å­</span>
  <span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//åˆ›å»ºå¯¹è±¡</span>
  xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'http://localhost:8100/upfile'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//è¿”å›å€¼</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>fileUrl<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">//alert('ä¸Šä¼ æˆåŠŸ');</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  xhr<span class="token punctuation">.</span>upload<span class="token punctuation">.</span>onprogress <span class="token operator">=</span> updateProgress<span class="token punctuation">;</span> <span class="token comment">// ä¸Šä¼ è¿›åº¦è°ƒç”¨æ–¹æ³•å®ç°</span>
  <span class="token keyword">function</span> <span class="token function">updateProgress</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>lengthComputable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> completedPercent <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>loaded <span class="token operator">/</span> event<span class="token punctuation">.</span>total <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      progressSpan<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> completedPercent <span class="token operator">+</span> <span class="token string">'%'</span><span class="token punctuation">;</span>
      progressSpan<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> completedPercent
      <span class="token keyword">if</span> <span class="token punctuation">(</span>completedPercent <span class="token operator">===</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//è¿›åº¦æ¡å˜è‰²</span>
        progressSpan<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å·²ä¸Šä¼ '</span><span class="token punctuation">,</span> completedPercent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//æ³¨æ„ send ä¸€å®šè¦å†™åœ¨æœ€ä¸‹é¢ï¼Œå¦åˆ™ onprogress åªä¼šæ‰§è¡Œæœ€åä¸€æ¬¡ ä¹Ÿå°±æ˜¯100%çš„æ—¶å€™</span>
  xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å‘é€æ—¶  Content-Typeé»˜è®¤å°±æ˜¯: multipart/form-data;</span>
</code></pre></div><h4 id="æ€»ç»“-2"><a href="#æ€»ç»“-2" aria-hidden="true" class="header-anchor">#</a> æ€»ç»“</h4> <p>å¦‚æœæ˜¯ä¸€æ¬¡è¯·æ±‚ä¸Šä¼ å¤šä¸ªæ–‡ä»¶éœ€è¦æ˜¾ç¤ºä¸€ä¸ªè¿›åº¦æ¡ï¼Œä¸Šé¢ä»‹ç»çš„æ–¹æ³•è¶³ä»¥å®ç°ï¼›å¦‚æœæ˜¯å¤§æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ å¤šæ¬¡è¯·æ±‚çš„è¯ï¼Œä¹Ÿæ˜¯å¯ä»¥åšåˆ°å•è¿›åº¦æç¤ºï¼Œåé¢ä¼šè¯¦ç»†ä»‹ç»ã€‚</p> <h3 id="æ‹–æ‹½ä¸Šä¼ "><a href="#æ‹–æ‹½ä¸Šä¼ " aria-hidden="true" class="header-anchor">#</a> æ‹–æ‹½ä¸Šä¼ </h3> <p>æ‹–æ‹½ä¸Šä¼ çš„åœºæ™¯æˆ‘ä»¬ä¹Ÿä¼šç»å¸¸é‡åˆ°ï¼Œåœ¨ HTML 5 ä¹‹å‰ï¼Œæƒ³è¦å®ç° Drag and Dropï¼ˆæ‹–æ‹½/æ‹–æ”¾ï¼‰ä¸€èˆ¬éœ€è¦æ±‚åŠ©äº JQueryï¼Œç°åœ¨æˆ‘ä»¬èƒ½ç®€å•çš„å¯¹ä»»æ„å…ƒç´ å®ç°æ‹–æ”¾åŠŸèƒ½ã€‚æ ¸å¿ƒæ˜¯ç†è§£åŸç”Ÿçš„æ‹–æ‹½äº‹ä»¶ï¼Œå¯ä»¥ç®€å•åˆ’åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ï¼š</p> <ul><li>å®šä¹‰ä¸€ä¸ªå…è®¸æ‹–æ”¾æ–‡ä»¶çš„åŒºåŸŸ <code>div.drop-box</code> (å¦‚æœæ˜¯æ‹–æ‹½å…¶ä»–å…ƒç´ ï¼Œæ˜¯è¦è®¾ç½® <code>draggable=&quot;true&quot;</code>ï¼Œè¿™é‡Œä¸Šä¼ æ–‡ä»¶æ‰€ä»¥ä¸éœ€è¦)</li> <li>å–æ¶ˆæœ‰å…³æ‹–æ‹½äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºï¼Œä¹Ÿå°±æ˜¯ <code>e.preventDefault()</code></li> <li>ä¸ºè¿™ä¸ªæ‹–æ”¾åŒºåŸŸæ·»åŠ æ‹–æ‹½æ ·å¼</li> <li>åœ¨ <code>drop</code> äº‹ä»¶è·å–æ–‡ä»¶ä¿¡æ¯ <code>e.dataTransfer.files</code></li></ul> <p>å…ˆä»ä¸€å¼ å›¾äº†è§£ä¸€ä¸‹æ‹–æ‹½åˆ†åˆ«ä¼šè§¦å‘å“ªäº›äº‹ä»¶ï¼š</p> <ul><li>drag source: æ˜¯æˆ‘ä»¬æ‹–æ‹½çš„æºå…ƒç´ </li> <li>intermediate zone: æ˜¯æ‹–æ‹½è¿‡ç¨‹å¯èƒ½ç»è¿‡çš„åŒºåŸŸ</li> <li>drop target: æ˜¯æœ€ç»ˆæ‹–æ”¾çš„ç›®æ ‡å…ƒç´ </li></ul> <p><img src="/Notebook/assets/img/dragEvent.92ff73ec.png" alt=""></p> <p><img src="/Notebook/assets/img/drag-start.ca38023e.png" alt=""> <img src="/Notebook/assets/img/drag-enter.c383a189.png" alt=""> <img src="/Notebook/assets/img/drop.26919dcb.png" alt=""> <img src="/Notebook/assets/img/drop-end.b6caaf2f.png" alt=""></p> <p>æ¥çœ‹å®é™…æ —å­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// è¿™ä¸ªæ˜¯æˆ‘ä»¬çš„æ‹–æ”¾åŒºåŸŸ</span>
  <span class="token keyword">const</span> box <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'drop-box'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//è®¾ç½®æ‹–æ‹½äº‹ä»¶</span>
  <span class="token keyword">function</span> <span class="token function">openDropEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    box<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;dragover&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// è®¾ç½®è¿›å…¥æ‹–æ”¾åŒºåŸŸæ ·å¼</span>
    box<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;dragenter&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'element dragenter'</span><span class="token punctuation">)</span>
      <span class="token comment">// ä¸ºä»€ä¹ˆä¸åœ¨ dragover è®¾ç½®å‘¢ï¼Ÿå› ä¸ºè§¦å‘å¤ªé¢‘ç¹äº†ï¼ŒChrome å®æµ‹ 1ms å·¦å³è§¦å‘ï¼›Firefox å¤§æ¦‚æ˜¯ 300ms</span>
      box<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'hilight'</span><span class="token punctuation">)</span>
      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// è®¾ç½®ç¦»å¼€æ‹–æ”¾åŒºåŸŸæ ·å¼</span>
    box<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;dragleave&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'elemenet dragleave'</span><span class="token punctuation">)</span>
      box<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">'hilight'</span><span class="token punctuation">)</span>
      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// é¼ æ ‡æ¾å¼€é‡Šæ”¾æ–‡ä»¶åˆ°æ‹–æ”¾åŒºåŸŸ</span>
    box<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;drop&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'element drop'</span><span class="token punctuation">)</span>
      box<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">'hilight'</span><span class="token punctuation">)</span>
      <span class="token comment">//å–æ¶ˆæµè§ˆå™¨é»˜è®¤æ‹–æ‹½æ•ˆæœï¼Œå¦åˆ™æµè§ˆå™¨ä¼šé»˜è®¤æ‰“å¼€æ–‡ä»¶</span>
      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//è·å–æ‹–æ‹½ä¸­çš„æ–‡ä»¶å¯¹è±¡</span>
      <span class="token keyword">const</span> fileList <span class="token operator">=</span> e<span class="token punctuation">.</span>dataTransfer<span class="token punctuation">.</span>files<span class="token punctuation">;</span>
      <span class="token comment">//ç”¨æ¥è·å–æ–‡ä»¶çš„é•¿åº¦ï¼ˆå…¶å®æ˜¯è·å¾—æ–‡ä»¶æ•°é‡ï¼‰</span>
      <span class="token keyword">const</span> len <span class="token operator">=</span> fileList<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fielist is array?'</span><span class="token punctuation">,</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>fileList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">//æ£€æµ‹æ˜¯å¦æ˜¯æ‹–æ‹½æ–‡ä»¶åˆ°é¡µé¢çš„æ“ä½œ</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        box<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">'over'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// å› ä¸ºæ˜¯ FileList å¯¹è±¡ ä¸èƒ½ç›´æ¥ç”¨ forEach</span>
      <span class="token comment">// è§£å†³é‡å¤æ·»åŠ æ–‡ä»¶çš„å¤„ç†</span>
      <span class="token keyword">let</span> files <span class="token operator">=</span> window<span class="token punctuation">.</span>willUploadFileList <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>fileList<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> fileName <span class="token operator">=</span> item<span class="token punctuation">.</span>name
        <span class="token keyword">if</span> <span class="token punctuation">(</span>files <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>files<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">file</span> <span class="token operator">=&gt;</span> file<span class="token punctuation">.</span>name <span class="token operator">===</span> fileName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          files<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> dropBox <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'drop-box'</span><span class="token punctuation">)</span>
      dropBox<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
      files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">file</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> fileName <span class="token operator">=</span> file<span class="token punctuation">.</span>name
      <span class="token keyword">const</span> divFileName <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
      divFileName<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'file-name'</span>
      divFileName<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> fileName
      dropBox<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>divFileName<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
       window<span class="token punctuation">.</span>willUploadFileList <span class="token operator">=</span> files
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h4 id="è¡¥å……"><a href="#è¡¥å……" aria-hidden="true" class="header-anchor">#</a> è¡¥å……</h4> <p>è¿™ç¯‡åšå®¢æœ‰åŠ©äºæˆ‘ä»¬æ›´å¥½çš„è®¤è¯†æ‹–æ‹½äº‹ä»¶ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»çœ‹çœ‹ï¼š<a href="https://lotabout.me/2018/HTML-5-Drag-and-Drop/" target="_blank" rel="noopener noreferrer">https://lotabout.me/2018/HTML-5-Drag-and-Drop/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="ç²˜è´´ä¸Šä¼ "><a href="#ç²˜è´´ä¸Šä¼ " aria-hidden="true" class="header-anchor">#</a> ç²˜è´´ä¸Šä¼ </h3> <p>æ ¸å¿ƒæ˜¯ç›‘å¬ <code>paste</code> äº‹ä»¶å’Œè·å–ç²˜è´´æ¿æ•°æ®</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// ç²˜è´´ä¸Šä¼ </span>
  <span class="token keyword">const</span> editorBox <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'editor-box'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// ç›‘å¬ç²˜è´´äº‹ä»¶</span>
  editorBox<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'paste'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// IEæµè§ˆå™¨åªæ”¯æŒ windown.clipboardDataè·å–ç²˜è´´æ¿æ•°æ®</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>clipboardData <span class="token operator">||</span> window<span class="token punctuation">.</span>clipboardData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> items <span class="token punctuation">}</span> <span class="token operator">=</span> data
    <span class="token keyword">const</span> fileList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//å­˜å‚¨æ–‡ä»¶æ•°æ®</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>items <span class="token operator">&amp;&amp;</span> items<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// æ£€ç´¢å‰ªåˆ‡æ¿items</span>
      Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        fileList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span><span class="token function">getAsFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    window<span class="token punctuation">.</span>willUploadFileList <span class="token operator">=</span> fileList<span class="token punctuation">;</span>
    event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">submitPasteUpload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">submitPasteUpload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">const</span> fileList <span class="token operator">=</span> window<span class="token punctuation">.</span>willUploadFileList <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fileList<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'è¯·é€‰æ‹©æ–‡ä»¶'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//æ„é€ FormDataå¯¹è±¡</span>
    Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>fileList<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">f</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ”¯æŒå¤šæ–‡ä»¶ä¸Šä¼ </span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8100/upfile'</span><span class="token punctuation">,</span> fd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>fileUrl<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span>
          img<span class="token punctuation">.</span>src <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>fileUrl<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
          img<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">'100px'</span>
          <span class="token function">insertNodeToEditor</span><span class="token punctuation">(</span>editorBox<span class="token punctuation">,</span> img<span class="token punctuation">)</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ä¸Šä¼ æˆåŠŸ'</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

  <span class="token comment">//å…‰æ ‡å¤„æ’å…¥ dom èŠ‚ç‚¹</span>
  <span class="token keyword">function</span> <span class="token function">insertNodeToEditor</span><span class="token punctuation">(</span><span class="token parameter">editor<span class="token punctuation">,</span> ele</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//æ’å…¥dom èŠ‚ç‚¹</span>
    <span class="token keyword">let</span> range<span class="token punctuation">;</span><span class="token comment">//è®°å½•å…‰æ ‡ä½ç½®å¯¹è±¡</span>
    <span class="token keyword">const</span> node <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>anchorNode<span class="token punctuation">;</span>
    <span class="token comment">// è¿™é‡Œåˆ¤æ–­æ˜¯åšæ˜¯å¦æœ‰å…‰æ ‡åˆ¤æ–­ï¼Œå› ä¸ºå¼¹å‡ºæ¡†é»˜è®¤æ˜¯æ²¡æœ‰çš„</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      range <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRangeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è·å–å…‰æ ‡èµ·å§‹ä½ç½®</span>
      range<span class="token punctuation">.</span><span class="token function">insertNode</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// åœ¨å…‰æ ‡ä½ç½®æ’å…¥è¯¥å¯¹è±¡</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      editor<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><h4 id="æ€»ç»“-3"><a href="#æ€»ç»“-3" aria-hidden="true" class="header-anchor">#</a> æ€»ç»“</h4> <p>ç²˜è´´ä¸Šä¼ çš„åœºæ™¯æ¯”è¾ƒå°‘ï¼Œæ‰€ä»¥å®é™…æµ‹è¯•çš„æ —å­ä¹Ÿä¸å¤šï¼Œè¿™é‡Œè¿˜å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼Œæš‚æ—¶æ²¡æƒ³åˆ°æ€ä¹ˆè§£å†³ï¼šä¸€æ˜¯ç²˜è´´å¤šä¸ªæ–‡ä»¶åªèƒ½æˆåŠŸå¤åˆ¶æœ€åä¸€ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯åªæœ‰æœ€åä¸€ä¸ªæ–‡ä»¶æˆåŠŸä¸Šä¼ ï¼›äºŒæ˜¯ <code>windows</code> ç³»ç»Ÿä¸æ”¯æŒç£ç›˜å¤åˆ¶æ–‡ä»¶ä¸Šä¼ ï¼Œ <code>mac</code>ç³»ç»Ÿæ˜¯å¯ä»¥æ”¯æŒçš„</p> <h3 id="å¤§æ–‡ä»¶æ–­ç‚¹ç»­ä¼ "><a href="#å¤§æ–‡ä»¶æ–­ç‚¹ç»­ä¼ " aria-hidden="true" class="header-anchor">#</a> å¤§æ–‡ä»¶æ–­ç‚¹ç»­ä¼ </h3> <p>ä¸Šä¼ çš„æ–‡ä»¶å¤ªå¤§æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥è€ƒè™‘å°†æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ ã€‚</p> <p><strong>æ€è·¯</strong> æ˜¯è¿™æ ·çš„ï¼š é€‰æ‹©ä¸Šä¼ ä¸€ä¸ª 60+MB çš„å¤§æ–‡ä»¶ï¼ŒæŒ‰æ¯ 10MB è¿›è¡Œåˆ†ç‰‡ï¼Œå‘é€åˆ°æœåŠ¡å™¨æ—¶æºå¸¦ä¸€ä¸ªæ ‡å¿—(è¿™é‡Œç”¨çš„æ˜¯æ—¶é—´æˆ³ï¼Œå…·ä½“å¯ä»¥ä¸åç«¯åè°ƒ)ï¼ŒæœåŠ¡ç«¯ç”Ÿæˆä¸´æ—¶æ–‡ä»¶ï¼Œåœ¨æœ€åä¸€ä¸ªåˆ†ç‰‡ä¸Šä¼ å®Œæˆåï¼Œå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªä¸Šä¼ ç»“æŸè¯·æ±‚åˆå¹¶æ–‡ä»¶çš„è¯·æ±‚ï¼ŒæœåŠ¡ç«¯å°†æ‰€æœ‰æ–‡ä»¶åˆ†ç‰‡æŒ‰ç…§æ ‡å¿—åˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶ï¼Œæœ€åæ¸…ç†ä¸´æ—¶æ–‡ä»¶</p> <p><img src="/Notebook/assets/img/slice-file.b46341e5.jpg" alt=""></p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">let</span> file
  <span class="token keyword">function</span> <span class="token function">submitUpload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> chunkSize <span class="token operator">=</span> <span class="token number">20</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1000</span> <span class="token comment">// åˆ†ç‰‡å¤§å°ï¼Œå¯è®¾ç½®ä¸º 10 20 100</span>
    file <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'f1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment">// è·å–æ–‡ä»¶å¯¹è±¡</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'è¯·é€‰æ‹©ä¸Šä¼ æ–‡ä»¶'</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> chunks <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>size <span class="token operator">/</span> chunkSize<span class="token punctuation">)</span> <span class="token comment">// è®¡ç®—è¿™ä¸ªæ–‡ä»¶å¯ä»¥åˆ‡æˆå‡ å—</span>
    <span class="token keyword">const</span> fileChunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// æ–‡ä»¶åˆ†ç‰‡åç»„æˆä¸€ä¸ªæ•°ç»„</span>
    <span class="token keyword">const</span> token <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// æ–‡ä»¶å”¯ä¸€æ ‡è¯†ï¼Œç”¨äºæœ€ååˆå¹¶æ–‡ä»¶</span>

    <span class="token comment">// File å¯¹è±¡ç»§æ‰¿äº† Blob çš„å±æ€§æ–¹æ³•ï¼Œè€Œ Blob å®ƒè¡¨ç¤ºåŸå§‹æ•°æ®,ä¹Ÿå°±æ˜¯äºŒè¿›åˆ¶æ•°æ®</span>
    <span class="token comment">// æä¾›äº†å¯¹æ•°æ®æˆªå–çš„æ–¹æ³• sliceï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨æ­¤æ–¹æ³•å¯¹æ–‡ä»¶è¿›è¡Œåˆ†æ®µ</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span>size <span class="token operator">&gt;</span> chunkSize<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// åˆ¤æ–­æ–‡ä»¶å¤§å°æ˜¯å¦å¤§äº çº¦å®šåˆ†ç‰‡çš„å¤§å°</span>
      <span class="token keyword">const</span> start <span class="token operator">=</span> <span class="token number">0</span>            <span class="token comment">// å¼€å§‹åˆ†ç‰‡</span>
      <span class="token keyword">const</span> end <span class="token operator">=</span> <span class="token number">0</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        end <span class="token operator">+=</span> chunkSize
        <span class="token keyword">const</span> blob <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span>
        start <span class="token operator">+=</span> chunkSize
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>blob<span class="token punctuation">.</span>size<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">break</span> <span class="token comment">//æ‹†åˆ†ç»“æŸ</span>
        <span class="token punctuation">}</span>
        fileChunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        fileChunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
</code></pre></div><p>æ–‡ä»¶å¯¹è±¡ï¼š
<img src="/Notebook/assets/img/file-object.729de6b3.png" alt=""></p> <p>æ–‡ä»¶åˆ†ç‰‡ç»“æœï¼š</p> <p><img src="/Notebook/assets/img/file-slice-result.4a5bf103.png" alt=""></p> <p>æ¥ç€æ˜¯å¤„ç†ä¸Šä¼ çš„é€»è¾‘ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token keyword">const</span> progressSpan <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'progress'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>firstElementChild <span class="token comment">// ç®€å•é…ä¸€ä¸‹è¿›åº¦æ¡</span>
    progressSpan<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">'0'</span>
    progressSpan<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span>

    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token comment">// æŒ‰é¡ºåºä¸Šä¼ </span>
    <span class="token keyword">const</span> <span class="token function-variable function">upLoadInOrder</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">//æ„é€ FormDataå¯¹è±¡</span>
        fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span> <span class="token comment">// ä¸åç«¯åè°ƒåˆ†ç‰‡éœ€è¦ä¼ é€è¿‡å»çš„å‚æ•°ï¼Œä¸€èˆ¬æ˜¯æ–‡ä»¶çš„æ ‡è¯†idï¼Œåˆ†ç‰‡é•¿åº¦ï¼Œåˆ†ç‰‡çš„åºå·ã€æ‰€å é•¿åº¦ç­‰ç­‰</span>
        fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'f1'</span><span class="token punctuation">,</span> fileChunks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> fileChunks<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ä¸Šä¼ å®Œæˆï¼Œå‘é€åˆå¹¶è¯·æ±‚'</span><span class="token punctuation">)</span>
          <span class="token keyword">const</span> formD <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          formD<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token string">'merge'</span><span class="token punctuation">)</span>
          formD<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span>
          formD<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'chunks'</span><span class="token punctuation">,</span> fileChunks<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
          formD<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'filename'</span><span class="token punctuation">,</span> file<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
          axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8100/upfile'</span><span class="token punctuation">,</span> formD<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
                  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'ä¸Šä¼ å®Œæˆï¼'</span><span class="token punctuation">)</span>
              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> chunks<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
              <span class="token function-variable function">onUploadProgress</span><span class="token punctuation">:</span> <span class="token parameter">progressEvent</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">const</span> complete <span class="token operator">=</span> <span class="token punctuation">(</span>progressEvent<span class="token punctuation">.</span>loaded <span class="token operator">/</span> progressEvent<span class="token punctuation">.</span>total <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">)</span>
                progressSpan<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> complete <span class="token operator">+</span> <span class="token string">'%'</span>
                progressSpan<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> complete
                <span class="token keyword">if</span> <span class="token punctuation">(</span>complete <span class="token operator">===</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// è¿›åº¦æ¡å˜è‰²</span>
                  progressSpan<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token comment">// ä¸æ˜¯å¿…é¡»çš„ å¯ä»¥åœ¨è¿™é‡Œå‘ŠçŸ¥æœåŠ¡ç«¯æˆ‘ä¸Šä¼ çš„ç‰‡æ®µä¿¡æ¯</span>
              headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">'Content-Range'</span><span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">bytes </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i <span class="token operator">*</span> chunkSize<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fileChunks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>size <span class="token operator">+</span> i <span class="token operator">*</span> chunkSize<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8100/upfile'</span><span class="token punctuation">,</span> fd<span class="token punctuation">,</span> config<span class="token punctuation">)</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                progressSpan<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">'0'</span>
                progressSpan<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span>
                i<span class="token operator">++</span>
                <span class="token function">upLoadInOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token function">upLoadInOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">//ç»‘å®šæäº¤äº‹ä»¶</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn-submit'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> submitUpload<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ çš„è¿‡ç¨‹ï¼Œä½†å¾€å¾€å®é™…æƒ…å†µä¸ä¼šé‚£ä¹ˆå®Œç¾ï¼Œå¦‚æœä¸Šä¼ åˆ†ç‰‡çš„è¿‡ç¨‹ä¸­ç½‘ç»œä¸­æ–­ï¼Œé‚£ä¹‹å‰ä¸Šä¼ çš„åˆ†ç‰‡å°±ä¼šä¸¢å¤±ï¼Œæˆ‘ä»¬æ˜¯ä¸å¸Œæœ›è¿™ç§æƒ…å†µå‘ç”Ÿçš„ï¼Œæœ€å¥½å°±æ˜¯èƒ½å¤Ÿåœ¨ä¸Šä¸€æ¬¡ä¸­æ–­çš„åœ°æ–¹ç»§ç»­ä¸Šä¼ æ–‡ä»¶ï¼Œäºæ˜¯å°±æœ‰äº†æ–­ç‚¹ç»­ä¼ è¿™ä¸ªæ¦‚å¿µã€‚</p> <p>ä»€ä¹ˆæ˜¯æ–­ç‚¹ç»­ä¼ å‘¢ï¼Ÿç®€å•æ¥è®²å°±æ˜¯ä¸Šä¼ æ–‡ä»¶è¿‡ç¨‹å‡ºç°çº¿è·¯ä¸­æ–­ï¼Œå®¢æˆ·ç«¯å†æ¬¡ä¸Šä¼ æ—¶ï¼Œèƒ½æ ¹æ®æœåŠ¡ç«¯è¿”å›çš„ä¿¡æ¯åœ¨ä¸­æ–­çš„åœ°æ–¹ç»§ç»­æ–‡ä»¶çš„ä¸Šä¼ ï¼Œèƒ½å¤ŸèŠ‚çœä¸Šä¼ æ—¶é—´ä¹Ÿæé«˜äº†æ•ˆç‡ã€‚</p> <p><img src="/Notebook/assets/img/slice-file-update.c4338c6a.png" alt=""></p> <p>åˆ¤æ–­æ–‡ä»¶ä¸­æ–­ä¸Šä¼ çš„ä½ç½®è¿™é‡Œç”¨çš„æ˜¯ <code>localStorage</code> ä¿å­˜ä¸Šä¼ åˆ†ç‰‡æˆåŠŸçš„ä¿¡æ¯ï¼Œåœ¨é¡¹ç›®ä¸­ï¼Œè¿™ä¸ªä¿¡æ¯ä¸€èˆ¬æ˜¯ç”±åç«¯æä¾›ï¼Œå‰ç«¯åªéœ€è¦è°ƒç”¨ä¸€ä¸ªæŸ¥è¯¢ç¼“å­˜çš„æ¥å£ï¼Œè·å–å½“å‰æ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸Šçš„ç¼“å­˜ä¿¡æ¯ï¼Œè¿”å›å·²ç¼“å­˜æ–‡ä»¶çš„æ ‡è¯†å’Œå¤§å°ï¼Œè¿™ä¸ªå¤§å°å°±æ˜¯ç”¨æ¥å†³å®šæˆ‘ä»¬ä»æ–‡ä»¶å“ªé‡Œè¿›è¡Œç»­ä¼ </p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> saveChunkKey <span class="token operator">=</span> <span class="token string">'chunkUploaded'</span>


    <span class="token comment">//æ€è·¯æ¦‚æ‹¬</span>
    <span class="token comment">//æŠŠå¤§æ–‡ä»¶åˆ†æˆæ¯10M ä¸€å—è¿›è¡Œä¸Šä¼ ï¼Œå‘é€åˆ°æœåŠ¡å™¨åŒæ—¶æºå¸¦ä¸€ä¸ªæ ‡å¿— æš‚æ—¶ç”¨å½“å‰çš„æ—¶é—´æˆ³ ï¼Œ</span>
    <span class="token comment">//æœåŠ¡ç«¯ç”Ÿæˆä¸´æ—¶æ–‡ä»¶ï¼ŒæœåŠ¡ç«¯æ¥å—ä¸€ä¸ªæ–‡ä»¶ç»“æŸçš„æ ‡å¿— ï¼Œç„¶åå°†æ‰€æœ‰çš„æ–‡ä»¶è¿›è¡Œåˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶ï¼Œæ¸…ç†ä¸´æ—¶æ–‡ä»¶ã€‚ è¿”å›ç»“æœï¼ˆçœ‹æƒ…å†µï¼‰</span>
    <span class="token keyword">function</span> <span class="token function">submitUpload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">debugger</span>
        <span class="token keyword">const</span> chunkSize <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">;</span><span class="token comment">//2m</span>

        <span class="token keyword">const</span> file <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'f1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> chunks <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>size <span class="token operator">/</span> chunkSize<span class="token punctuation">)</span> <span class="token comment">// è®¡ç®—è¿™ä¸ªæ–‡ä»¶å¯ä»¥åˆ‡æˆå‡ å—</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">æ€»å…±</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>chunks<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ä¸ªåˆ†ç‰‡</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> token <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// æ–‡ä»¶å”¯ä¸€æ ‡è¯†ï¼Œç”¨äºæœ€ååˆå¹¶æ–‡ä»¶</span>
        <span class="token keyword">const</span> fileChunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

        <span class="token keyword">const</span> progressSpan <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'progress'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>firstElementChild <span class="token comment">// ç®€å•é…ä¸€ä¸‹è¿›åº¦æ¡</span>
        progressSpan<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">'0'</span>
        progressSpan<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'è¯·é€‰æ‹©æ–‡ä»¶'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//æ‹†åˆ†æ–‡ä»¶</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span>size <span class="token operator">&gt;</span> chunkSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//æ‹†åˆ†æ–‡ä»¶</span>
            <span class="token keyword">var</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                end <span class="token operator">+=</span> chunkSize<span class="token punctuation">;</span>
                <span class="token keyword">var</span> blob <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                start <span class="token operator">+=</span> chunkSize<span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>blob<span class="token punctuation">.</span>size<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">//æ‹†åˆ†ç»“æŸ</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                fileChunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            fileChunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">const</span> uploadedInfo <span class="token operator">=</span> <span class="token function">getUploadedFromStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>uploadedInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">const</span> <span class="token function-variable function">upLoadInOrder</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// const uploadedIndex = uploadedInfo.findIndex(up =&gt; up === true)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>uploadedInfo<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// è¯´æ˜æœ‰åˆ†ç‰‡ç¼“å­˜</span>
                i<span class="token operator">++</span>
                <span class="token function">upLoadInOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">const</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">//æ„é€ FormDataå¯¹è±¡</span>
            fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span> <span class="token comment">// ä¸åç«¯åè°ƒåˆ†ç‰‡éœ€è¦ä¼ é€è¿‡å»çš„å‚æ•°ï¼Œä¸€èˆ¬æ˜¯æ–‡ä»¶çš„æ ‡è¯†idï¼Œåˆ†ç‰‡é•¿åº¦ï¼Œåˆ†ç‰‡çš„åºå·ã€æ‰€å é•¿åº¦ç­‰ç­‰</span>
            fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'f1'</span><span class="token punctuation">,</span> fileChunks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> chunks<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ä¸Šä¼ å®Œæˆï¼Œå‘é€åˆå¹¶è¯·æ±‚'</span><span class="token punctuation">)</span>
                <span class="token keyword">const</span> formD <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                formD<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token string">'merge'</span><span class="token punctuation">)</span>
                formD<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span>
                formD<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'chunkCount'</span><span class="token punctuation">,</span> chunks<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
                formD<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'filename'</span><span class="token punctuation">,</span> file<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
                axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8100/upfile'</span><span class="token punctuation">,</span> formD<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
                        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'ä¸Šä¼ å®Œæˆï¼'</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> chunks<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
                    <span class="token function-variable function">onUploadProgress</span><span class="token punctuation">:</span> <span class="token parameter">progressEvent</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                        <span class="token keyword">const</span> complete <span class="token operator">=</span> <span class="token punctuation">(</span>progressEvent<span class="token punctuation">.</span>loaded <span class="token operator">/</span> progressEvent<span class="token punctuation">.</span>total <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">)</span>
                        progressSpan<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> complete <span class="token operator">+</span> <span class="token string">'%'</span>
                        progressSpan<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> complete
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>complete <span class="token operator">===</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// è¿›åº¦æ¡å˜è‰²</span>
                            progressSpan<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8100/upfile'</span><span class="token punctuation">,</span> fd<span class="token punctuation">,</span> config<span class="token punctuation">)</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'sendChunkCount'</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
                    <span class="token function">setUploadedToStorage</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
                    i<span class="token operator">++</span>
                    <span class="token function">upLoadInOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">upLoadInOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
        <span class="token comment">//è·å¾—æœ¬åœ°ç¼“å­˜çš„æ•°æ®</span>
    <span class="token keyword">function</span> <span class="token function">getUploadedFromStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>saveChunkKey<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&quot;{}&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//å†™å…¥ç¼“å­˜</span>
    <span class="token keyword">function</span> <span class="token function">setUploadedToStorage</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> uploaded <span class="token operator">=</span> <span class="token function">getUploadedFromStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        uploaded<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
        localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>saveChunkKey<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>uploaded<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre></div><h4 id="è¡¥å……ï¼š"><a href="#è¡¥å……ï¼š" aria-hidden="true" class="header-anchor">#</a> è¡¥å……ï¼š</h4> <p>å½“æˆ‘ä»¬è¿›è¡Œæ–­ç‚¹ç»­ä¼ æ—¶ï¼Œä¸€èˆ¬ä¼šåœ¨<strong>è¯·æ±‚å¤´</strong>æ·»åŠ  <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Range" target="_blank" rel="noopener noreferrer">Range<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å¦‚ <code>Range: byte=2000-4000</code>,å‘Šè¯‰æœåŠ¡ç«¯æˆ‘ä»¬è¦è·å– 2000byte åˆ° 4000byte çš„æ–‡ä»¶å—æ•°æ®ï¼›
è€ŒæœåŠ¡ç«¯åœ¨è¿”å›çš„<strong>å“åº”å¤´</strong>å°±ä¼šæºå¸¦ä¸€ä¸ª <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Range" target="_blank" rel="noopener noreferrer">Content-Range<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> å¦‚ <code>Content-Range: 2000-4000/67589</code>, æ˜¾ç¤ºçš„æ˜¯ä¸€ä¸ªæ•°æ®ç‰‡æ®µåœ¨æ•´ä¸ªæ–‡ä»¶ä¸­çš„ä½ç½®</p> <h4 id="é—®é¢˜ï¼š"><a href="#é—®é¢˜ï¼š" aria-hidden="true" class="header-anchor">#</a> é—®é¢˜ï¼š</h4> <p>å¦‚æœæˆ‘ä»¬æƒ³è¦åˆ†ç‰‡ä¸Šä¼ æˆ‘ä»¬çš„å¤§æ–‡ä»¶ä½†åˆåªæƒ³ä»¥ä¸€ä¸ªè¿›åº¦æ¡æ˜¾ç¤ºï¼Œè¯·é—®è¦å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ <code>onUploadProgress</code> è¿˜æ˜¯åœ¨è¿™ä¸ªåœ°æ–¹å¤„ç†</p> <h4 id="ç­”æ¡ˆï¼š"><a href="#ç­”æ¡ˆï¼š" aria-hidden="true" class="header-anchor">#</a> ç­”æ¡ˆï¼š</h4> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">onUploadProgress</span><span class="token punctuation">:</span> <span class="token parameter">progressEvent</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> complete <span class="token operator">=</span> <span class="token punctuation">(</span>progressEvent<span class="token punctuation">.</span>loaded <span class="token operator">/</span> file<span class="token punctuation">.</span>size <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">)</span>
          <span class="token comment">// å¦‚æœæœ‰ç¼“å­˜ tempSize</span>
          <span class="token comment">// const complete = (progressEvent.loaded / (file.size - tempSize) * 100 | 0)</span>
          <span class="token comment">// æˆ–è€…</span>
          <span class="token comment">// const complete = ((progressEvent.loaded + tempSize) / file.size * 100 | 0)</span>
          progressSpan<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> complete <span class="token operator">+</span> <span class="token string">'%'</span>
          progressSpan<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> complete
          <span class="token keyword">if</span> <span class="token punctuation">(</span>complete <span class="token operator">===</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// è¿›åº¦æ¡å˜è‰²</span>
              progressSpan<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><h4 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" aria-hidden="true" class="header-anchor">#</a> æ€»ç»“ï¼š</h4> <p>æ–­ç‚¹ç»­ä¼ çš„æ ¸å¿ƒæ˜¯å¯¹æ–‡ä»¶çš„åˆ†å‰²å’Œä¸­æ–­ä½ç½®çš„è·å–</p> <h3 id="æ–‡ä»¶å¤¹ä¸Šä¼ "><a href="#æ–‡ä»¶å¤¹ä¸Šä¼ " aria-hidden="true" class="header-anchor">#</a> æ–‡ä»¶å¤¹ä¸Šä¼ </h3> <p>å½“éœ€è¦ä¸Šä¼ æ–‡ä»¶å¤¹æ—¶ï¼Œéœ€è¦åœ¨ inputä¸Šæ·»åŠ <strong>webkitdirectory</strong>å±æ€§ï¼ˆä»…æ”¯æŒè°·æ­Œæµè§ˆå™¨ï¼‰ï¼Œè¿™æ ·åœ¨é€‰æ‹©çš„æ—¶å€™å°±èƒ½é€‰æ‹©æ–‡ä»¶å¤¹ä¸Šä¼ äº†ã€‚è¿™é‡Œå¢åŠ ä¸€ç‚¹éš¾åº¦ï¼Œå°†æ–‡ä»¶å¤¹å‹ç¼©æ‰“åŒ…åå†ä¸Šä¼ ï¼Œé€‰ç”¨çš„åº“æ˜¯ <strong>JSZip</strong></p> <p>è¿™æ˜¯æˆ‘ä»¬å³å°†ä¸Šä¼ çš„æ–‡ä»¶å¤¹ç»“æ„:
<img src="/Notebook/assets/img/file-folder.3464e172.jpg" alt=""></p> <div class="language-html extra-class"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
    <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>zipFiles<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">multiple</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>multiple<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">webkitdirectory</span>
  <span class="token punctuation">/&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// åœ¨ @change ä¸­è·å–åˆ°äº†æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰çš„æ–‡ä»¶å¯¹è±¡ FileList</span>
  <span class="token function">zipFiles</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> files <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>target
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>è¿™æ˜¯æ‰“å°å‡ºæ¥çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå¯ä»¥çœ‹å‡ºæ–‡ä»¶çš„å±‚çº§è¢«<strong>æ‰å¹³åŒ–</strong>äº†ï¼Œå¦‚ä½•èƒ½è¿˜åŸå‡ºåŸæ¥çš„æ–‡ä»¶å¤¹å‘¢ï¼Ÿ
<img src="/Notebook/assets/img/file-list.cfb93579.jpg" alt=""></p> <p><a href="https://stuk.github.io/jszip" target="_blank" rel="noopener noreferrer">JSZip<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>æä¾›äº†ä¸¤ä¸ªå…³é”®çš„ APIï¼š</p> <ul><li>zip.file(name, data [,options]) åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</li> <li>zip.folder(name) åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> JSZip <span class="token keyword">from</span> <span class="token string">'jszip'</span>
  <span class="token function">zipFiles</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> files <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>target
    <span class="token keyword">const</span> zip <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSZip</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> files<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> path <span class="token operator">=</span> files<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>webkitRelativePath<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
      <span class="token comment">// æ ¹æ®æ–‡ä»¶è·¯å¾„ ç”Ÿæˆç›®æ ‡æ–‡ä»¶</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>path<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// abc/123.pdf</span>
        zip<span class="token punctuation">.</span><span class="token function">file</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> files<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>path<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// abc/hahhaha/456.pdf</span>
        zip<span class="token punctuation">.</span><span class="token function">folder</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">file</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> files<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>path<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// abc/hahhaha/aaaa/rollup-cjs.jpg</span>
        zip<span class="token punctuation">.</span><span class="token function">folder</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">folder</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">file</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> files<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>path<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// abc/hahhaha/bbb/hahahhab/rollup-umd.jpg</span>
        zip<span class="token punctuation">.</span><span class="token function">folder</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">folder</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">folder</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">file</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> files<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>ä»ä¸­å¯ä»¥å‘ç°é™¤äº†æ ¹èŠ‚ç‚¹å¤–ï¼Œfolderçš„åˆ›å»ºè·Ÿ pathçš„é•¿åº¦ç›¸å…³ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªé€’å½’å»ç”Ÿæˆç›®æ ‡æ–‡ä»¶</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> JSZip <span class="token keyword">from</span> <span class="token string">'jszip'</span>
<span class="token comment">// åœ¨ @change ä¸­è·å–åˆ°äº†æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰çš„æ–‡ä»¶å¯¹è±¡ FileList</span>
  <span class="token keyword">async</span> <span class="token function">zipFiles</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> files <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>target
    <span class="token keyword">const</span> zip <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSZip</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> files<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> path <span class="token operator">=</span> files<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>webkitRelativePath<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>path<span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// éæ ¹èŠ‚ç‚¹</span>
        <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">const</span> <span class="token function-variable function">deepPath</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> length</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>length <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// æ’è¿›æ–‡ä»¶</span>
            obj<span class="token punctuation">.</span><span class="token function">file</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> files<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            i<span class="token operator">++</span>
            <span class="token keyword">const</span> folder <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">folder</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// åˆ›å»ºæ–‡ä»¶å¤¹</span>
            <span class="token function">deepPath</span><span class="token punctuation">(</span>folder<span class="token punctuation">,</span> path<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">deepPath</span><span class="token punctuation">(</span>zip<span class="token punctuation">.</span><span class="token function">folder</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ ¹èŠ‚ç‚¹</span>
        zip<span class="token punctuation">.</span><span class="token function">file</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> files<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> arrPath <span class="token operator">=</span> files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>webkitRelativePath<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> content <span class="token operator">=</span> <span class="token keyword">await</span> zip<span class="token punctuation">.</span><span class="token function">generateAsync</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'blob'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token comment">// åˆ›å»ºfileå¯¹è±¡</span>
        <span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">[</span>content<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arrPath<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.zip</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'zip'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'æ‰“åŒ…å¤±è´¥ï¼'</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" aria-hidden="true" class="header-anchor">#</a> ä¸‹è½½</h2> <p>åç«¯ä¸€èˆ¬æä¾›ä¸€ä¸ª <code>URL</code>ï¼Œå‰ç«¯æ ¹æ®éœ€æ±‚ä¸åŒï¼Œå®ç°å®¢æˆ·ç«¯çš„ä¿å­˜ä¸‹è½½ã€‚æ ¹æ®è¿™ä¸ª<code>URL</code>ï¼Œå‰ç«¯å¤„ç†ä¸‹è½½çš„æ–¹å¼è¿˜å¯ä»¥ç»†åˆ†å‡ ç§ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p> <ul><li>a æ ‡ç­¾ä¸‹è½½</li> <li>iframe æ ‡ç­¾ä¸‹è½½</li> <li>location.href ä¸‹è½½</li> <li>FileSaver ä¸‹è½½</li></ul> <h3 id="aæ ‡ç­¾ä¸‹è½½"><a href="#aæ ‡ç­¾ä¸‹è½½" aria-hidden="true" class="header-anchor">#</a> aæ ‡ç­¾ä¸‹è½½</h3> <h4 id="æ­¥éª¤"><a href="#æ­¥éª¤" aria-hidden="true" class="header-anchor">#</a> æ­¥éª¤</h4> <ul><li>æ‹¿åˆ°æ–‡ä»¶url</li> <li>åˆ›å»º <code>a</code> æ ‡ç­¾ï¼Œå¹¶æ·»åŠ  <code>download</code> å±æ€§</li> <li>ç‚¹å‡»å³å¯ä¸‹è½½</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">downloadByA</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// åç«¯æä¾›çš„æ–‡ä»¶ url</span>
  <span class="token keyword">const</span> alink <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
  alink<span class="token punctuation">.</span>href <span class="token operator">=</span> url
  alink<span class="token punctuation">.</span>download <span class="token operator">=</span> <span class="token string">''</span> <span class="token comment">// è®¾ç½®æ–‡ä»¶å</span>
  alink<span class="token punctuation">.</span><span class="token function">cick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è™½ç„¶åªæœ‰åŒºåŒºå‡ æ®µä»£ç ï¼Œä½†é‡Œé¢å­¦ä¹ çš„ä¸œè¥¿è¿˜æ˜¯æœ‰å¾ˆå¤šï¼Œå¦‚è¿™ä¸ªh5çš„æ–°å±æ€§ <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/a" target="_blank" rel="noopener noreferrer">download<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> , èƒ½å¤Ÿè§£å†³å¦‚å›¾ç‰‡ã€æ–‡æœ¬æ–‡æ¡£ã€pdfç­‰æµè§ˆå™¨è‡ªåŠ¨åœ¨çº¿é¢„è§ˆè€Œä¸èƒ½ä¸‹è½½çš„é—®é¢˜ã€‚ä½†å®ƒå¹¶æ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆç¥é€šå¹¿å¤§ï¼Œé‡ä¸Šè·¨åŸŸçš„ url,å®ƒå°±å¤±æ•ˆäº†ã€‚</p> <p>é‚£ä¹ˆå¦‚ä½•è§£å†³è·¨åŸŸä¸­ <code>download</code> å¤±æ•ˆçš„é—®é¢˜å‘¢ï¼Ÿå®˜ç½‘ç»™æˆ‘ä»¬æŒ‡æ˜äº†æ–¹å‘ï¼šä½¿ç”¨ <code>blob:URL</code> å’Œ <code>data:URL</code>ã€‚å…¶å®aæ ‡ç­¾çš„<code>href</code>è¿˜å¯ä»¥æ¥å—é™¤äº†ç›¸å¯¹å’Œç»å¯¹è·¯å¾„ä¹‹å¤–çš„å…¶ä»–å½¢å¼Urlï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢æˆ‘ä»¬è¯´åˆ°çš„ <code>blob: URL</code> å’Œ <code>data: URL</code>ï¼Œæˆ–è®¸å¤§å®¶å¯¹è¿™ä¸¤ä¸ª URL æœ‰ç‚¹é™Œç”Ÿï¼Œæˆ‘ä»¬ä¸€æ­¥æ­¥å­¦ä¹ å®ƒä»¬</p> <h4 id="apiè§£æ"><a href="#apiè§£æ" aria-hidden="true" class="header-anchor">#</a> APIè§£æ</h4> <p><em>é¦–å…ˆ</em>ï¼Œè®¤è¯†ä¸€ä¸‹è¿™ä¸ª <strong>blob:URL</strong>ï¼Œblob:URL æ˜¯ç”±æµè§ˆå™¨å†…éƒ¨é€šè¿‡ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/URL/createObjectURL" target="_blank" rel="noopener noreferrer">URL.createObjectURL()<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ç”Ÿæˆ</p> <div class="language-js extra-class"><pre class="language-js"><code>objectUrl <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span> <span class="token comment">// è¿™é‡Œçš„ object å‚æ•°åªèƒ½æ˜¯ File æˆ– Blob å¯¹è±¡</span>
</code></pre></div><p>å®˜ç½‘çš„è§£é‡Šæ˜¯è¯´ <code>URL.createObjectURL()</code> é™æ€æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ª <code>DOMString</code>ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªè¡¨ç¤ºå‚æ•°ä¸­ç»™å‡ºå¯¹è±¡çš„ URLã€‚æˆ‘ç†è§£æ˜¯è¿™ä¸ª URL æŒ‡å‘çš„å°±æ˜¯æˆ‘ä»¬æä¾›çš„ File æˆ– Blob å¯¹è±¡çš„èµ„æºã€‚è¿™ä¸ª URL æ˜¯æœ‰ç”Ÿå‘½å‘¨æœŸçš„ï¼Œå®ƒå’Œåˆ›å»ºå®ƒçš„çª—å£ä¸­çš„ document ç»‘å®šã€‚æ‰€ä»¥ï¼Œéœ€è¦æ³¨æ„åœ¨æ¯æ¬¡è°ƒç”¨ createObjectURL() æ–¹æ³•åï¼Œå½“æˆ‘ä»¬ä¸å†éœ€è¦è¿™äº› URL å¯¹è±¡æ—¶ï¼Œå¿…é¡»é€šè¿‡è°ƒç”¨ URL.revokeObjectURL() æ–¹æ³•æ¥é‡Šæ”¾è¿™äº›å¯¹è±¡.</p> <p>è€Œ <strong><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/data_URIs" target="_blank" rel="noopener noreferrer">data:URL<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></strong> æ˜¯ä¸€ä¸ªåŒ…å«å†…å®¹ç¼–ç çš„ URL , å¯ç”± <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/FileReader" target="_blank" rel="noopener noreferrer">fileReader.readAsDataURL(blob / file)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> è·å¾—ã€‚å®ƒç”±å››ä¸ªéƒ¨åˆ†ç»„æˆï¼šå‰ç¼€(data:)ã€æŒ‡ç¤ºæ•°æ®ç±»å‹çš„MIMEç±»å‹ã€å¯é€‰çš„base64æ ‡è®°ã€æ•°æ®æœ¬èº«(å¦‚æœæ˜¯æ–‡æœ¬ç±»å‹ç›´æ¥åµŒå…¥ï¼Œå¦‚æœæ˜¯äºŒè¿›åˆ¶æ•°æ®åˆ™è¿›è¡Œbase64ç¼–ç ååµŒå…¥)ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>data<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token operator">&lt;</span>mediatype<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">;</span>base64<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">&lt;</span>data<span class="token operator">&gt;</span>

<span class="token comment">// å›¾ç‰‡ç±»å‹çš„ data:URL å¯ä»¥é€šè¿‡ canvas.toDataURL(&quot;image/&quot; + mime) è·å¾—</span>

<span class="token comment">// ç®€å•çš„ text/plain ç±»å‹æ•°æ®</span>
data<span class="token punctuation">:</span><span class="token punctuation">,</span>Hello<span class="token operator">%</span><span class="token number">2</span>C<span class="token operator">%</span><span class="token number">20</span>World<span class="token operator">!</span>
æˆ– base64 ç¼–ç åç‰ˆæœ¬ï¼šdata<span class="token punctuation">:</span>text<span class="token operator">/</span>plain<span class="token punctuation">;</span>base64<span class="token punctuation">,</span>SGVsbG8sIFdvcmxkIQ<span class="token operator">%</span><span class="token number">3</span>D<span class="token operator">%</span><span class="token number">3</span>D

<span class="token comment">// ä¸€ä¸ªHTMLæ–‡æ¡£æºä»£ç  &lt;h1&gt;Hello, World&lt;/h1&gt;</span>
data<span class="token punctuation">:</span>text<span class="token operator">/</span>html<span class="token punctuation">,</span><span class="token operator">%</span><span class="token number">3</span>Ch1<span class="token operator">%</span><span class="token number">3</span>EHello<span class="token operator">%</span><span class="token number">2</span>C<span class="token operator">%</span><span class="token number">20</span>World<span class="token operator">!</span><span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">2</span>Fh1<span class="token operator">%</span><span class="token number">3</span>E

</code></pre></div><p>âš éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œblob:URL æ˜¯å…è®¸Blobå¯¹è±¡ç”¨ä½œå›¾åƒï¼Œä¸‹è½½äºŒè¿›åˆ¶æ•°æ®é“¾æ¥ç­‰çš„URLæºï¼Œä½†å®ƒåªèƒ½åœ¨åº”ç”¨å†…éƒ¨ä½¿ç”¨ï¼Œæ˜¯ä¸€ç§<strong>ä¼ªåè®®URL</strong>, URLçš„ç”Ÿå‘½å‘¨æœŸå’Œåˆ›å»ºå®ƒçš„çª—å£ä¸­çš„documentç»‘å®šã€‚data:URLæ˜¯<strong>å‰ç¼€ä¸º data: åè®®çš„URL</strong>ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨ä¸Šéšæ„ä½¿ç”¨(blob:URLåªæ˜¯å¯¹æµè§ˆå™¨å­˜å‚¨åœ¨å†…å­˜ä¸­æˆ–è€…ç£ç›˜ä¸Šçš„Blobçš„ä¸€ä¸ªç®€å•å¼•ç”¨)ã€‚</p> <p>ä¸¾ä¸ªæ —å­ï¼šä¸‹è½½ä¸€å¼ æ¥è‡ªç½‘ä¸Šçš„å›¾ç‰‡</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å›¾ç‰‡æ¥è‡ªç½‘ä¸Šä¸€å¼ å¯çˆ±çš„å°æŸ¯åŸº http://img.mp.itc.cn/upload/20170605/9dea8e0dd718472aa913dae6a1e2b94b_th.jpg</span>

<span class="token keyword">function</span> <span class="token function">downloadImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">'http://img.mp.itc.cn/upload/20170605/9dea8e0dd718472aa913dae6a1e2b94b_th.jpg'</span>
  <span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// CORS ç­–ç•¥ï¼Œä¼šå­˜åœ¨è·¨åŸŸé—®é¢˜https://stackoverflow.com/questions/20424279/canvas-todataurl-securityerror</span>
  image<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;crossOrigin&quot;</span><span class="token punctuation">,</span> <span class="token string">'Anonymous'</span><span class="token punctuation">)</span>
  image<span class="token punctuation">.</span>src <span class="token operator">=</span> url
  image<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å¾— data:URL</span>
    <span class="token keyword">const</span> imageDataUrl <span class="token operator">=</span> <span class="token function">imageUrlToBase64</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>
    <span class="token keyword">const</span> downloadUrlDom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
    downloadUrlDom<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'href'</span><span class="token punctuation">,</span> imageDataUrl<span class="token punctuation">)</span>
    <span class="token comment">// // ç¬¬äºŒç§æ–¹å¼ å³å°†æ•°æ®è½¬ä¸ºBlobï¼Œå†å°†Blobç”ŸæˆBlobURLï¼Œä½¿ç”¨aæ ‡ç­¾ä¸‹è½½</span>
    <span class="token comment">// // åœ¨ç¬¬ä¸€ç§æ–¹å¼åŸºç¡€ä¸Šè·å¾— blob:URL</span>
    <span class="token comment">// const imageBlobData = dataUrlToBlob(imageDataUrl)</span>
    <span class="token comment">// console.log(imageBlobData);</span>
    <span class="token comment">// const imageBlobUrl = URL.createObjectURL(imageBlobData)</span>
    <span class="token comment">// downloadUrlDom.setAttribute('href', imageBlobUrl)</span>
    <span class="token comment">// è®¾ç½®æ–‡ä»¶åï¼Œä¸ä¸€å®šè¦å†™æ­»</span>
    downloadUrlDom<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'download'</span><span class="token punctuation">,</span> <span class="token string">'cuteDog'</span><span class="token punctuation">)</span>
    <span class="token comment">// å…¼å®¹æ€§åˆ¤æ–­</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'download'</span> <span class="token keyword">in</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// éIEä¸‹è½½</span>
    downloadUrlDom<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// IE10+ä¸‹è½½ éœ€è¦ç”¨ç¬¬äºŒç§æ–¹å¼è·å–åˆ° blob:URL</span>
    navigator<span class="token punctuation">.</span><span class="token function">msSaveBlob</span><span class="token punctuation">(</span>imageBlobUrl<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å°†å›¾ç‰‡urlè½¬æ¢æˆ base64</span>
<span class="token comment">// åŸç†ï¼š åˆ©ç”¨canvas.toDataURLçš„APIè½¬åŒ–æˆ data:URL</span>
<span class="token keyword">function</span> <span class="token function">imageUrlToBase64</span><span class="token punctuation">(</span><span class="token parameter">img</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> img<span class="token punctuation">.</span>width<span class="token punctuation">;</span>  
  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> img<span class="token punctuation">.</span>height<span class="token punctuation">;</span>  
  <span class="token comment">// è¿”å›ä¸€ä¸ª CanvasRenderingContext2D å¯¹è±¡ï¼Œä½¿ç”¨å®ƒå¯ä»¥ç»˜åˆ¶åˆ° Canvas å…ƒç´ ä¸­</span>
  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> img<span class="token punctuation">.</span>width<span class="token punctuation">,</span> img<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å‘ç”»å¸ƒä¸Šé¢ç»˜åˆ¶å›¾ç‰‡</span>
  <span class="token keyword">const</span> mime <span class="token operator">=</span> img<span class="token punctuation">.</span>src<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span>src<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–å›¾ç‰‡çš„å…·ä½“ç±»å‹</span>
  <span class="token keyword">const</span> dataUrl <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&quot;image/&quot;</span> <span class="token operator">+</span> mime<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æœ€ååˆ©ç”¨è¿”å›ä¸€ä¸ªåŒ…å«å›¾ç‰‡å±•ç¤ºçš„ data URI </span>
  <span class="token keyword">return</span> dataUrl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// data:URL è½¬ Blobæ•°æ®</span>
<span class="token comment">// å…¶å®å°±æ˜¯åˆ©ç”¨ data:URL æœ€åä¸€éƒ¨åˆ†çš„ç¼–ç æ•°æ®è¿›è¡Œè½¬æ¢</span>
<span class="token keyword">function</span> <span class="token function">dataUrlToBlob</span><span class="token punctuation">(</span><span class="token parameter">dataUrl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> arr <span class="token operator">=</span> dataUrl<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      mime <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/:(.*?);/</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      bStr <span class="token operator">=</span> <span class="token function">atob</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      n <span class="token operator">=</span> bStr<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
      unit8Array <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>n<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä»¥å¯¹è±¡çš„æ–¹å¼æˆ–ä½¿ç”¨æ•°ç»„ä¸‹æ ‡ç´¢å¼•çš„æ–¹å¼å¼•ç”¨æ•°ç»„ä¸­çš„å…ƒç´ </span>
    unit8Array<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> bStr<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è¿”å›æŒ‡å®šä½ç½®çš„å­—ç¬¦çš„ Unicode ç¼–ç </span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>unit8Array<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> mime <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> 

</code></pre></div><p>å†ä¸¾ä¸€ä¸ªæ —å­ï¼Œæˆ‘ä»¬ä¸‹è½½ä¸€ä¸ª pdf æ–‡ä»¶(ä¸ºä»€ä¹ˆé€‰æ‹© pdf å‘¢ï¼Ÿå› ä¸ºè¿™ä¹Ÿæ˜¯æµè§ˆå™¨èƒ½å¤Ÿåœ¨çº¿é¢„è§ˆçš„æ–‡ä»¶ç±»å‹ä¹‹ä¸€ï¼Œè€Œ zipã€docxã€xslxç­‰éƒ½èƒ½å¤Ÿç›´æ¥é€šè¿‡ a æ ‡ç­¾ä¸‹è½½ä¸ä¼šå‡ºç°è‡ªåŠ¨æ‰“å¼€çš„é—®é¢˜ã€‚)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å¦‚æœåç«¯è¿”å›çš„æ•°æ®æ˜¯ä¸€ä¸ªbanse64ç¼–ç çš„æ–‡ä»¶ï¼Œå‰ç«¯å°±éœ€è¦è¿›è¡Œä¸€ä¸‹è½¬æ¢</span>
<span class="token comment">// æˆ–è€…åœ¨è¯·æ±‚å¤´ä¸Šæ·»åŠ  responseType: 'blob', è¿™æ ·å¤„ç†èµ·æ¥ä¼šç®€å•å¾ˆå¤š</span>
<span class="token comment">// ä¸‹é¢è¿˜æ˜¯ä»¥ base64 æ ¼å¼æ–‡ä»¶è¿›è¡Œå¤„ç†</span>
<span class="token function">downloadPDF</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å°† base64 è½¬æ¢æˆ blob</span>
  <span class="token comment">// åç«¯èƒ½ç›´æ¥å¤„ç†æˆ blob å°±èƒ½çœç•¥è¿™äº›äº†</span>
  <span class="token keyword">const</span> <span class="token function-variable function">base64ToBlob</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dataUrl</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataUrl<span class="token punctuation">)</span>
    <span class="token keyword">const</span> arr <span class="token operator">=</span> dataUrl<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> mime <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/:(.*?);/</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token comment">// ç»è¿‡ base-64 ç¼–ç çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç </span>
    <span class="token keyword">const</span> bStr <span class="token operator">=</span> <span class="token function">atob</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> n <span class="token operator">=</span> bStr<span class="token punctuation">.</span>length
    <span class="token keyword">const</span> unit8Array <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>n<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ä»¥å¯¹è±¡çš„æ–¹å¼æˆ–ä½¿ç”¨æ•°ç»„ä¸‹æ ‡ç´¢å¼•çš„æ–¹å¼å¼•ç”¨æ•°ç»„ä¸­çš„å…ƒç´ </span>
      unit8Array<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> bStr<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token comment">//è¿”å›æŒ‡å®šä½ç½®çš„å­—ç¬¦çš„ Unicode ç¼–ç </span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>unit8Array<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> mime <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> alink <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
  <span class="token comment">// è¿™é‡Œè¯·æ±‚ä¸€ä¸ªæœ¬åœ°çš„ pdf æ–‡ä»¶ï¼Œç”¨çš„ koa æ¡†æ¶å†™çš„ä¸€äº›ç®€å•æœåŠ¡ï¼Œè¿”å›çš„ res.data æ˜¯ä¸€ä¸ªè¿›è¡Œ base64 ç¼–ç çš„æ–‡ä»¶</span>
  axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8100/downloads/JavaScript.pdf'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/pdf'</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> dataUrl <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">data:application/pdf;base64,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>res<span class="token punctuation">.</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token function">base64ToBlob</span><span class="token punctuation">(</span>dataUrl<span class="token punctuation">)</span>
    <span class="token comment">// å¦‚æœ res æ˜¯ä¸€ä¸ª blob æ•°æ®ï¼Œç›´æ¥è·³åˆ°è¿™ä¸€æ­¥å³å¯</span>
    <span class="token comment">// ç›´æ¥è·å–ä¸€ä¸ª blob:URL è¿›è¡Œä¸‹è½½æ“ä½œ</span>
    alink<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'href'</span><span class="token punctuation">,</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">)</span>
    alink<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'download'</span><span class="token punctuation">,</span> <span class="token string">'JavaScript'</span><span class="token punctuation">)</span>
    alink<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="ç–‘é—®"><a href="#ç–‘é—®" aria-hidden="true" class="header-anchor">#</a> ç–‘é—®</h4> <p>æˆ–è®¸ä¼šæœ‰äººæ„Ÿåˆ°ç–‘æƒ‘ï¼Œå¦‚æœ <code>data:URL</code> å°±èƒ½å¤Ÿè§£å†³<strong>èµ„æºè·¨åŸŸ</strong>çš„é—®é¢˜ä¸ºä»€ä¹ˆè¿˜è¦ç»§ç»­ç”¨<code>blob:URL</code>å‘¢ï¼Ÿ é¦–å…ˆï¼Œ <code>data:URL</code> æ˜¯ä¸€ä¸ªåŒ…å«å†…å®¹ç¼–ç çš„ URL, å¦‚æœç¼–ç æ•°æ®è¿‡é•¿ï¼Œè¿™ä¸ª URL æœ‰å¯èƒ½ä¼šè¶…è¿‡æµè§ˆå™¨çš„é™åˆ¶è€Œå‡ºç°æŠ¥é”™ã€‚å…¶æ¬¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåœ¨è¯·æ±‚æ—¶ï¼Œè®¾ç½® <code>responseType = blob</code>æ¥è·å–æˆ‘ä»¬éœ€è¦çš„ <code>blob</code>æ ¼å¼çš„æ•°æ®ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹è½¬æ¢æˆ <code>blob:URL</code>æ˜¯æ¯”è¾ƒç®€å•æ–¹ä¾¿çš„ã€‚</p> <h4 id="æ€»ç»“-4"><a href="#æ€»ç»“-4" aria-hidden="true" class="header-anchor">#</a> æ€»ç»“</h4> <p>aæ ‡ç­¾ä¸‹è½½çš„æ–¹å¼è¿˜æ˜¯å¾ˆé€šç”¨çš„ï¼Œå¦‚æœå‡ºç°åœ¨çº¿æ‰“å¼€çš„é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨è½¬æ¢ URL çš„æ–¹å¼å®ç°ä¿å­˜ä¸‹è½½ï¼›è€Œå¦‚æœéœ€è¦æˆ‘ä»¬è‡ªå®šä¹‰ä¸‹è½½è¿›åº¦ï¼Œå¯ä»¥å†è€ƒè™‘é€šè¿‡ <code>axios</code> è¯·æ±‚è·å–è¿›åº¦ï¼Œ å†é…åˆ data:URL æˆ– blob:URL ä¸‹è½½ã€‚ä½†ç¼ºç‚¹æ˜¯å®ƒä¸å…¼å®¹ IE æµè§ˆå™¨ï¼Œåé¢æˆ‘ä»¬ä¼šè®²è§£å¦‚ä½•åœ¨ IE ä¸Šä¿å­˜ä¸‹è½½ã€‚</p> <h4 id="è¡¥å……èµ„æ–™ï¼š"><a href="#è¡¥å……èµ„æ–™ï¼š" aria-hidden="true" class="header-anchor">#</a> è¡¥å……èµ„æ–™ï¼š</h4> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLCanvasElement/toDataURL" target="_blank" rel="noopener noreferrer">canvas.toDataURL<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WindowBase64/atob" target="_blank" rel="noopener noreferrer">atob<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array" target="_blank" rel="noopener noreferrer">Uint8Array<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/charCodeAt" target="_blank" rel="noopener noreferrer">charCodeAt<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/msSaveBlob" target="_blank" rel="noopener noreferrer">msSaveBlob<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="location-hrefä¸‹è½½"><a href="#location-hrefä¸‹è½½" aria-hidden="true" class="header-anchor">#</a> location.hrefä¸‹è½½</h3> <p>location.href è¿™ç§ä¸‹è½½æ–¹å¼åŸºæœ¬ä¸ä½¿ç”¨ï¼Œè¯­æ³•å¾ˆç®€å•ï¼Œä½†çµæ´»æ€§æ¯”è¾ƒå·®</p> <div class="language-js extra-class"><pre class="language-js"><code>location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">'../downloads/cutegirl.jpg'</span>
</code></pre></div><p>å®ƒçš„ç¼ºç‚¹æ˜¯æœ€æ˜æ˜¾çš„ï¼Œæµè§ˆå™¨æ”¯æŒåœ¨çº¿é¢„è§ˆçš„å›¾ç‰‡ã€æ–‡æœ¬æ–‡æ¡£ã€pdfæ–‡ä»¶éƒ½ä¼šåœ¨çº¿æ‰“å¼€ä¸ä¼šæç¤ºä¸‹è½½ï¼Œä¸èƒ½åƒ <code>a</code> æ ‡ç­¾çš„ <code>href</code> é‚£æ ·æ¥å—å…¶ä»–å½¢å¼çš„ <code>URL</code>, æ‰€ä»¥ç°åœ¨éƒ½æ¯”è¾ƒå°‘ç”¨åˆ°è¿™ç§æ–¹å¼å¤„ç†ä¸‹è½½</p> <h3 id="iframeä¸‹è½½"><a href="#iframeä¸‹è½½" aria-hidden="true" class="header-anchor">#</a> iframeä¸‹è½½</h3> <p><code>iframe</code> ä½¿ç”¨ç›¸ä¿¡å¾ˆå¤šå°ä¼™ä¼´éƒ½æœ‰ç”¨è¿‡ï¼Œæˆ‘ä»¬åœ¨å¤„ç†åœ¨çº¿é¢„è§ˆ <code>pdf</code> æˆ–è€…åµŒå…¥å…¶ä»–æ¡†æ¶æ—¶ä¼šç”¨åˆ°ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå…¶å®å®ƒè¿˜å¯ä»¥ç”¨ä½œæ–‡ä»¶çš„ä¸‹è½½ï¼Œä½¿ç”¨ä¸Šä¸ <code>a</code> æ ‡ç­¾æœ‰ç‚¹ç›¸ä¼¼ï¼Œéƒ½æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªæ ‡ç­¾åè¿›è¡Œä¸‹è½½ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯èƒ½å¤Ÿå®ç°æ— åˆ·æ–°ä¸‹è½½ï¼Œä½“éªŒæ„Ÿè¾ƒå¥½ã€‚ä½†å®ƒçš„ç¼ºç‚¹ä¹Ÿæ˜¯æ˜æ˜¾çš„ï¼Œæˆ‘ä»¬æ²¡åŠæ³•é¢„æµ‹åˆ°æ–‡ä»¶ä»€ä¹ˆæ—¶å€™å¯åŠ¨ä¸‹è½½æˆ–å®Œæˆä¸‹è½½ï¼Œæ·»åŠ åˆ°é¡µé¢ <code>body</code>ä¸Šçš„ <code>iframe</code> æ ‡ç­¾ä¹Ÿæ— æ³•ç›‘å¬åˆ é™¤ã€‚</p> <p>å°æ —å­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// æ— é—ªç°ä¸‹è½½excel</span>
  <span class="token keyword">function</span> <span class="token function">handleDownIframe</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç¼ºç‚¹æ˜¯æ— æ³•ç›‘å¬ä¸‹è½½è¿›åº¦ï¼Œæ— æ³•å‰”é™¤ iframe æ ‡ç­¾</span>
    <span class="token comment">// å¦‚æœæ–‡ä»¶ç±»å‹æ˜¯ å›¾ç‰‡ã€æ–‡æœ¬æ–‡æ¡£ç±»å‹ä¹Ÿä¸èƒ½å‡ºç°ä¿å­˜ä¸‹è½½</span>
    <span class="token keyword">const</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'iframe'</span><span class="token punctuation">)</span>
    iframe<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
    iframe<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'../downloads/helpFile.docx'</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre></div><h4 id="æ€»ç»“-5"><a href="#æ€»ç»“-5" aria-hidden="true" class="header-anchor">#</a> æ€»ç»“</h4> <p>iframe ä¸‹è½½å’Œ location.href çš„ç¼ºç‚¹éƒ½æ˜¯ä¸èƒ½ä¿å­˜ä¸‹è½½æµè§ˆå™¨æ”¯æŒé¢„è§ˆçš„æ–‡ä»¶ï¼Œä¹Ÿä¸èƒ½é€šè¿‡è½¬æ¢ URL æ¥å¤„ç†ï¼ŒåŒæ—¶ iframe ä¸åƒ a æ ‡ç­¾å¯ä»¥é€šè¿‡ç‚¹å‡»äº‹ä»¶è§¦å‘ä¸‹è½½ï¼Œå®ƒå¿…é¡»æ·»åŠ åˆ°é¡µé¢æ‰èƒ½è§¦å‘ä¸‹è½½ï¼Œæˆ‘ä»¬æ— æ³•ç¡®å®šä»€ä¹ˆæ—¶å€™å¯ä»¥å»æ‰è¿™ä¸ª iframe æ ‡ç­¾ã€‚å€¼å¾—å­¦ä¹ çš„æ˜¯ï¼Œ iframe èƒ½æ”¯æŒå¤šæ¬¡ç‚¹å‡»ä¸‹è½½ï¼Œæ–‡ä»¶ä¸‹è½½äº’ä¸å½±å“ï¼›è€Œ a æ ‡ç­¾æ˜¯éœ€è¦ç­‰å¾…æœåŠ¡å™¨å“åº”æ‰èƒ½è¿›è¡Œä¸‹è½½æ“ä½œï¼Œå¦‚æœå¤šæ¬¡ç‚¹å‡»ä¸‹è½½ï¼Œç»“æœåªæœ‰æœ€åä¸€ä¸ªæ–‡ä»¶æ˜¯çœŸæ­£ä¸‹è½½æˆåŠŸçš„</p> <h3 id="filesaver-ä¸‹è½½"><a href="#filesaver-ä¸‹è½½" aria-hidden="true" class="header-anchor">#</a> FileSaver ä¸‹è½½</h3> <p>å¦‚æœåç«¯è¿”å›çš„æ˜¯ä»¥æ–‡ä»¶æµçš„æ ¼å¼ï¼Œå‰ç«¯åªéœ€åœ¨è¯·æ±‚å¤´è®¾ç½®ä¸€ä¸ª <code>responseType = 'blob'</code>ï¼Œå†é€šè¿‡ä¸Šé¢æ‰€è®²çš„æ–¹æ³•è¿›è¡Œä¸‹è½½å³å¯ï¼Œé‚£è¿™é‡Œä¸ºä»€ä¹ˆè¿˜è¦å¦å¤–å¼€ä¸€ä¸ªå†…å®¹å‘¢ï¼Ÿå…¶å®æ˜¯é™¤äº† <code>a</code> æ ‡ç­¾å¤–ï¼Œè¿˜æœ‰ä¸€äº›å…¼å®¹æ€§æ›´å¥½çš„æ–¹å¼è¿›è¡Œä¸‹è½½ï¼Œæ¥ä¸‹æ¥ä»‹ç»ä¸€ä¸‹ <a href="https://github.com/eligrey/FileSaver.js" target="_blank" rel="noopener noreferrer">FileSaver<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> è¿™ä¸ªå¸¸ç”¨åº“ã€‚</p> <p>é¦–å…ˆï¼Œä¸ºä»€ä¹ˆéœ€è¦ç”¨åˆ°è¿™ä¸ªåº“ï¼Ÿä¸Šé¢è®²åˆ° <code>a</code> æ ‡ç­¾ä¸‹è½½ä¼šæœ‰ä¸ªæµè§ˆå™¨å…¼å®¹çš„é—®é¢˜ï¼Œä¸‹é¢è¿™ä¸ªæ˜¯ <code>a</code> æ ‡ç­¾çš„ download å±æ€§çš„å…¼å®¹æ€§æˆªå›¾ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œçš„ <strong>IE</strong> æ˜¯ä¸æ”¯æŒçš„ï¼Œè€Œæˆ‘ä»¬æ— æ³•ä¿è¯ç”¨æˆ·åœ¨ä½¿ç”¨è¿‡ç¨‹æ˜¯ç”¨çš„å“ªç±»æµè§ˆå™¨ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªæ›´å¥½çš„æ–¹å¼é¿å…å‡ºç°å› å…¼å®¹é—®é¢˜è€Œä¸èƒ½ä¸‹è½½æ–‡ä»¶çš„ç°è±¡ã€‚è€Œ <strong>FileSaver</strong> å°±æ˜¯èƒ½å¤Ÿåœ¨ä¸ä½¿ç”¨ <code>a</code> æ ‡ç­¾çš„æƒ…å†µä¸‹æˆ–è€…æ²¡æœ‰åŸç”Ÿæ”¯æŒ <code>saveAs()</code> çš„æµè§ˆå™¨ä¸Šå®ç°å®¢æˆ·ç«¯ä¿å­˜æ–‡ä»¶ä»¥åŠåœ¨çº¿ç”Ÿæˆæ–‡ä»¶ä¿å­˜çš„éœ€æ±‚ã€‚</p> <h4 id="a-æ ‡ç­¾å„å±æ€§"><a href="#a-æ ‡ç­¾å„å±æ€§" aria-hidden="true" class="header-anchor">#</a> a æ ‡ç­¾å„å±æ€§</h4> <p><img src="/Notebook/assets/img/download-compatibility.e49888d1.png" alt=""></p> <p>æ¥ç€æˆ‘ä»¬æ¥çœ‹çœ‹ <strong>FileSaver</strong> æ”¯æŒçš„æµè§ˆå™¨ä»¥åŠèƒ½å¤Ÿæ”¯æŒçš„æ–‡ä»¶æ•°æ®å¤§å°æ˜¯å¤šå°‘</p> <p><img src="/Notebook/assets/img/fileSaver-compatibility.aba6da92.png" alt=""></p> <p>å¯ä»¥çœ‹åˆ°ï¼Œ<strong>FileSaver</strong> èƒ½å¤Ÿå…¼å®¹å¤§éƒ¨åˆ†çš„æµè§ˆå™¨ï¼Œè€Œä¸”æ”¯æŒä¿å­˜çš„æ–‡ä»¶å¤§å°ä¹Ÿèƒ½æ»¡è¶³ä¸€èˆ¬çš„ä¸šåŠ¡éœ€æ±‚ï¼Œå¦‚æœå¤„ç†çš„æ˜¯ <strong>IE</strong> æµè§ˆå™¨ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨åˆ° <a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/msSaveBlob" target="_blank" rel="noopener noreferrer">navigator.msSaveBlob()<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> è¿™ä¸ªæ–¹æ³•ã€‚æ¥çœ‹çœ‹ <strong>FileSaver</strong> çš„è¿ç”¨</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// é‡‡ç”¨ cdn å¼•å…¥</span>
  <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;https://cdn.bootcss.com/FileSaver.js/2014-11-29/FileSaver.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

  <span class="token comment">// FileSaver ä¸‹è½½å›¾ç‰‡æ–‡ä»¶</span>
  <span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  image<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;crossOrigin&quot;</span><span class="token punctuation">,</span> <span class="token string">'Anonymous'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  image<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'http://img.mp.itc.cn/upload/20170605/9dea8e0dd718472aa913dae6a1e2b94b_th.jpg'</span>
  image<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç»§ç»­æ²¿ç”¨è¿™å‡ ä¸ªæ•°æ®è½¬æ¢çš„æ–¹æ³•</span>
    <span class="token keyword">const</span> imageDataUrl <span class="token operator">=</span> <span class="token function">imageUrlToBase64</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> imageBlobData <span class="token operator">=</span> <span class="token function">dataUrlToBlob</span><span class="token punctuation">(</span>imageDataUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> downloadImageDom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'download-image'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    downloadImageDom<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">saveAs</span><span class="token punctuation">(</span>imageBlobData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// FileSaver ä¸‹è½½åœ¨çº¿ç”Ÿæˆçš„æ–‡æœ¬æ–‡ä»¶</span>
  <span class="token keyword">const</span> txtDownloadDom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'download-txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  txtDownloadDom<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> textarea <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'textarea'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> filename <span class="token operator">=</span> <span class="token function">generateFilename</span><span class="token punctuation">(</span><span class="token string">'textareaName'</span><span class="token punctuation">,</span> <span class="token string">'.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> textBlob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>textarea<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">&quot;text/plain;charset=utf-8&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">saveAs</span><span class="token punctuation">(</span>textBlob<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>ä¸Šé¢éƒ½æ˜¯æ¯”è¾ƒç®€å•çš„ç›´æ¥è°ƒç”¨ <strong>api</strong> å®ç°ä¸‹è½½çš„éœ€æ±‚ï¼Œä½†é™¤äº†ä¸Šé¢çš„ç®€å•çš„ä½¿ç”¨å¤–ï¼ŒFileSaver å…¶å®è¿˜æœ‰ä¸€ä¸ªæ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œé‚£å°±æ˜¯å°†åœ¨çº¿ç”Ÿæˆçš„æ–‡æ¡£ä¸‹è½½ä¸‹æ¥ã€‚
è¿™ä¸ªåœºæ™¯è¿˜æ˜¯æ¯”è¾ƒå¸¸è§çš„ï¼Œæˆ‘ä»¬ä¼šé‡åˆ°ç±»ä¼¼éœ€è¦åœ¨çº¿å¡«å†™è¡¨æ ¼ï¼Œå¹¶ä¿å­˜æˆexcelæ ¼å¼ä¸‹è½½ä¸‹æ¥ï¼Œä¹Ÿå°±æ˜¯å¸¸å¸¸è¯´çš„<strong>æŠ¥è¡¨ä¸‹è½½</strong>ã€‚ä¸€èˆ¬é…åˆä½¿ç”¨å°±æ˜¯ <a href="https://github.com/SheetJS/sheetjs" target="_blank" rel="noopener noreferrer">js-xlsx<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>æˆ‘ä»¬å†æ¥çœ‹çœ‹åœ¨çº¿ç”Ÿæˆ <code>excel</code> å¹¶ä¿å­˜ä¸‹è½½çš„ æ —å­:</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// åŒæ ·é‡‡ç”¨ cdn å¼•å…¥</span>
  <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;https://cdn.bootcss.com/xlsx/0.14.1/xlsx.full.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

  <span class="token comment">// ä¸‹è½½excelæ–‡ä»¶</span>
  <span class="token keyword">const</span> excelDownloadDom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'download-excel'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  excelDownloadDom<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ³¨æ„ï¼šXLSX.uitls.table_to_book( æ”¾å…¥çš„æ˜¯table çš„DOM èŠ‚ç‚¹ )</span>
    <span class="token comment">// sheetjs.xlsx å³ä¸ºå¯¼å‡ºè¡¨æ ¼çš„åå­—ï¼Œå¯ä¿®æ”¹</span>
    <span class="token comment">// åˆ›å»ºä¸€ä¸ªå·¥ä½œç°¿å¯¹è±¡</span>
    <span class="token keyword">const</span> wb <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">table_to_book</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#table-excel'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> wopts <span class="token operator">=</span> <span class="token punctuation">{</span> bookType<span class="token punctuation">:</span> <span class="token string">'xlsx'</span><span class="token punctuation">,</span> bookSST<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'array'</span> <span class="token punctuation">}</span> <span class="token comment">// è¾“å‡ºé…ç½®</span>
    <span class="token keyword">const</span> wbout <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> wopts <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¾“å‡º</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token function">saveAs</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>wbout<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'application/octet-stream'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'table-excel.xlsx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> console <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> wbout<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>workbook</strong>ï¼š</p> <p><img src="/Notebook/assets/img/workbook-object.d7a9433b.png" alt=""></p> <p><code>table_to_book</code> æ˜¯å®˜æ–¹æä¾›ç»™æˆ‘ä»¬çš„å·¥å…·å‡½æ•°ï¼Œèƒ½å¤Ÿå°†æˆ‘ä»¬æä¾›çš„æ•°æ®è½¬æ¢æˆä¸€ä¸ª <code>workbook</code> å¯¹è±¡ï¼Œå¦‚ä¸Šé¢çš„æ —å­ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ª <code>table-dom</code>ä¸Šçš„æ•°æ®è½¬æ¢æˆäº†ä¸€ä¸ª <code>workbook</code> å¯¹è±¡ï¼Œé€šè¿‡æ‰“å°ä¿¡æ¯å¯ä»¥çœ‹åˆ°ï¼ŒSheetNamesé‡Œé¢ä¿å­˜äº†æ‰€æœ‰çš„sheetåå­—ï¼Œç„¶åSheetsåˆ™ä¿å­˜äº†æ¯ä¸ªsheetçš„å…·ä½“å†…å®¹ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºSheet Objectï¼‰ã€‚æ¯ä¸€ä¸ªsheetæ˜¯é€šè¿‡ç±»ä¼¼A1è¿™æ ·çš„é”®å€¼ä¿å­˜æ¯ä¸ªå•å…ƒæ ¼çš„å†…å®¹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå•å…ƒæ ¼å¯¹è±¡ï¼ˆCell Objectï¼‰</p> <p><code>XLSX.wirte</code> å°±æ˜¯å°†æˆ‘ä»¬çš„ <code>workbook</code> å¯¹è±¡æŒ‰ç…§æŒ‡å®šçš„æ–‡ä»¶ç±»å‹è¾“å‡º</p> <p>æƒ³è¦ç»§ç»­ç ”ç©¶è¿™ä¸ª <code>js-xlsx</code> åº“çš„çš„ä½¿ç”¨ï¼Œå°ä¼™ä¼´å¯ä»¥çœ‹çœ‹è¿™å‡ ç¯‡åšå®¢ï¼š</p> <p><a href="https://www.cnblogs.com/liuxianan/p/js-excel.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/liuxianan/p/js-excel.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://blog.csdn.net/tian_i/article/details/84327329" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/tian_i/article/details/84327329<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>å¦‚æœéœ€è¦ç ”ç©¶ docx æ–‡æ¡£ä¿å­˜çš„å°ä¼™ä¼´ï¼Œè¿˜å¯ä»¥çœ‹çœ‹è¿™ä¸ªï¼š</p> <p><a href="https://www.cnblogs.com/liuxianan/p/js-excel.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/liuxianan/p/js-excel.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="æ–‡ä»¶ä¸‹è½½"><a href="#æ–‡ä»¶ä¸‹è½½" aria-hidden="true" class="header-anchor">#</a> æ–‡ä»¶ä¸‹è½½</h2> <p>æ‹¿å›¾ç‰‡ä¸ºä¾‹å­ï¼Œå­˜å‚¨æœ‰ä¸¤ç§æ–¹å¼ï¼š</p> <p>å¯ä»¥å°†å›¾ç‰‡ä»¥ç‹¬ç«‹çš„æ–‡ä»¶çš„å½¢å¼å­˜å‚¨å†æœåŠ¡æ±‚çš„æŒ‡å®šæ–‡ä»¶å¤¹ä¸­ï¼Œå†å°†è·¯å¾„å­˜å…¥æ•°æ®åº“å­—æ®µä¸­ï¼›
ä¹Ÿå¯ä»¥å°†å›¾ç‰‡è½¬æ¢æˆäºŒè¿›åˆ¶æµï¼Œç›´æ¥å­˜å‚¨åˆ°æ•°æ®åº“çš„ <code>Image</code> ç±»å‹å­—æ®µä¸­ã€‚</p> <p>é‚£ä¹ˆåœ¨åç«¯ï¼Œå¯ä»¥ç›´æ¥è¿”å›è¯¥å›¾ç‰‡æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥è¿”å›å›¾ç‰‡æµã€‚å‰ç«¯æ ¹æ®è¿™ä¸¤ç§æ–¹å¼è¿›è¡Œå¤„ç†ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>formCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è¡¨å• code</span>
  <span class="token keyword">const</span> src <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token constant">API</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token constant">API_FILE_DIR</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">rest/pas/v1/naturalRes/dataform/download/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>formCode<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// åˆ›å»ºéšè—çš„å¯ä¸‹è½½é“¾æ¥;</span>
  <span class="token keyword">let</span> eleLink <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  eleLink<span class="token punctuation">.</span>download <span class="token operator">=</span> formName<span class="token punctuation">;</span>
  eleLink<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span><span class="token punctuation">;</span>
  <span class="token comment">// å­—ç¬¦å†…å®¹è½¬å˜æˆblobåœ°å€</span>
  eleLink<span class="token punctuation">.</span>href <span class="token operator">=</span> src<span class="token punctuation">;</span>
  <span class="token comment">// è§¦å‘ç‚¹å‡»</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>eleLink<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// if (document.all) {</span>
  <span class="token comment">// åˆ¤æ–­æ˜¯å¦ä¸º IE æµè§ˆå™¨</span>
  <span class="token comment">// eleLink.addEventListener('click', () =&gt; {</span>
  <span class="token comment">//   console.log('click');</span>
  <span class="token comment">// })</span>
  <span class="token comment">// eleLink.click(); // è¿™ç§æ–¹å¼æ— æ³•è§¦å‘ä¸‹è½½</span>
  <span class="token comment">// } else</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>createEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> event <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createEvent</span><span class="token punctuation">(</span><span class="token string">'MouseEvents'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    event<span class="token punctuation">.</span><span class="token function">initEvent</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    eleLink<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ç„¶åç§»é™¤</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    eleLink<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>isDownLoading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token function">logAction</span><span class="token punctuation">(</span>logConfig<span class="token punctuation">.</span>NatureAnaEva<span class="token punctuation">.</span>xzcg<span class="token punctuation">,</span> <span class="token punctuation">{</span> targetObj<span class="token punctuation">:</span> formName <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$Message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'æ— æ³•ç”Ÿæˆ excel è¡¨'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="æ–‡ä»¶åœ¨çº¿ç”Ÿæˆ"><a href="#æ–‡ä»¶åœ¨çº¿ç”Ÿæˆ" aria-hidden="true" class="header-anchor">#</a> æ–‡ä»¶åœ¨çº¿ç”Ÿæˆ</h2> <h3 id="æˆªå›¾"><a href="#æˆªå›¾" aria-hidden="true" class="header-anchor">#</a> æˆªå›¾</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// æˆªå›¾</span>
  <span class="token keyword">const</span> printCanvas <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">html2canvas</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    backgroundColor<span class="token punctuation">:</span> <span class="token string">'#ffffff'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  dataURL <span class="token operator">=</span> printCanvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">'image/png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span>dataURL<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç­‰å¾…åœ°å›¾åŠ è½½å®Œæˆï¼Œarcgis æ²¡æä¾›åŠ è½½å®Œæˆé€šçŸ¥</span>
</code></pre></div><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" aria-hidden="true" class="header-anchor">#</a> å‚è€ƒèµ„æ–™</h2> <ul><li><a href="http://jartto.wang/2018/01/19/play-image-stream/" target="_blank" rel="noopener noreferrer">ç©è½¬å›¾ç‰‡æµ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> â€”â€” å¦‚æœä½ è®¤çœŸçš„çœ‹å®Œäº†æ–‡ç« ï¼Œé‚£ä¹ˆä»¥åä½ å¯¹å›¾ç‰‡æ•°æ®çš„å¤„ç†å°±ä¼šé¡ºç•…å¾ˆå¤šã€‚</li> <li><a href="https://www.zhihu.com/question/27996269" target="_blank" rel="noopener noreferrer">å¦‚ä½•ç†è§£ç¼–ç¨‹è¯­è¨€ä¸­ã€Œæµã€ï¼ˆstreamï¼‰çš„æ¦‚å¿µï¼Ÿ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> â€”â€” æµæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦æœ‰æµï¼Œèƒ½å¤Ÿä»ä¸­æ¢å‡ºä¸€äºŒã€‚</li> <li><a href="https://segmentfault.com/a/1190000018234223" target="_blank" rel="noopener noreferrer">å‰ç«¯å®ç°æ‰¹é‡å¯¼å‡ºå›¾ç‰‡å¹¶æ‰“åŒ…å‹ç¼©åŠŸèƒ½<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2/2/2021, 1:24:26 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/Notebook/frontend-web/security.html" class="prev">
          å‰ç«¯å®‰å…¨
        </a></span> <span class="next"><a href="/Notebook/frontend-web/interview.html">
          å¸¸è§é—®é¢˜ 1
        </a>
        â†’
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Notebook/assets/js/app.fae3116e.js" defer></script><script src="/Notebook/assets/js/3.8a90166b.js" defer></script><script src="/Notebook/assets/js/5.01244a1f.js" defer></script>
  </body>
</html>
